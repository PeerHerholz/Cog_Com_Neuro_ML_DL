
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EEG preprocessing with MNE &#8212; Spring term 2022</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Evoked potentials/ERPs with MNE" href="mne_erp.html" />
    <link rel="prev" title="MNE python for EEG analysis" href="mne_introduction.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/cog_com_neuro_ml_dl_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Spring term 2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../index.html">
   Welcome!
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../dei.html">
   Diversity, Equity and Inclusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../overview.html">
   Course overview &amp; procedure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../outline.html">
   General outline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../setup.html">
   Setup for the course
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../pages/introduction.html">
   Introduction
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/introduction_1.html">
     Introduction I - General introduction
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../../pages/introduction_2.html">
     Introduction II - Neuroscience
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="cortical_maps.html">
       Cortical maps
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="mri_intro.html">
       Magnetic Resonance Imaging (MRI)
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="image_manipulation_nibabel.html">
         Using Python for neuroimaging data - NiBabel
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="morphometry.html">
       Morphometric analyzes
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="dMRI_intro.html">
       Diffusion MRI
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="diffusion_imaging.html">
         Structural connectivity and diffusion imaging
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="fmri_intro.html">
       Functional MRI
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
      <label for="toctree-checkbox-5">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="image_manipulation_nilearn.html">
         Using Python for neuroimaging data - Nilearn
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="statistical_maps.html">
       Statistical maps
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="statistical_analyses_MRI.html">
         Nilearn GLM: statistical analyses of MRI in Python
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="connectivity_intro.html">
       Functional connectivity
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
      <label for="toctree-checkbox-7">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="functional_connectivity.html">
         Functional connectivity and resting state
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 current active has-children">
      <a class="reference internal" href="eeg_introduction.html">
       Electroencephalography
      </a>
      <input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul class="current">
       <li class="toctree-l4">
        <a class="reference internal" href="mne_introduction.html">
         MNE python for EEG analysis
        </a>
       </li>
       <li class="toctree-l4 current active">
        <a class="current reference internal" href="#">
         EEG preprocessing with MNE
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="mne_erp.html">
         Evoked potentials/ERPs with MNE
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="mne_workflow_tutorial.html">
         MNE Workflow tutorial
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../pages/introduction_3.html">
     Introduction III - NeuroDataScience
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../pages/neurodata/replicability_open_science.html">
       Replicability crisis, open science &amp; pre-registration
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../pages/neurodata/data_management.html">
       Project &amp; data management
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../neurodata/pybids.html">
         Introduction to
         <code class="docutils literal notranslate">
          <span class="pre">
           pybids
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../pages/neurodata/version_control_general.html">
       Version control
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
      <label for="toctree-checkbox-11">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../neurodata/version_control.html">
         Introduction to git and github
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../pages/neurodata/literature.html">
       Finding &amp; organizing literature
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../pages/neurodata/project_101.html">
       Connecting the dots
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../pages/introduction_4.html">
     Introduction IV - Linear Algebra
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/LinearAlgebra.html">
       Linear Algebra
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../pages/introduction_5.html">
     Introduction V - Artificial Intelligence
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../artificial_intelligence/terms_definitions.html">
       Models, AI and all other buzz words
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../artificial_intelligence/ML_intro.html">
       Supervised or unsupervised &amp; model types
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../projects.html">
   Student projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../break.html">
   Yoga and/or dance break
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../questionnaires.html">
   Questionnaire templates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../CoC.html">
   Code of Conduct
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/introduction/notebooks/neuroscience/mne_preprocessing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/PeerHerholz/Cog_Com_Neuro_ML_DL"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/PeerHerholz/Cog_Com_Neuro_ML_DL/issues/new?title=Issue%20on%20page%20%2Fintroduction/notebooks/neuroscience/mne_preprocessing.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/PeerHerholz/Cog_Com_Neuro_ML_DL/edit/main/lecture/introduction/notebooks/neuroscience/mne_preprocessing.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/PeerHerholz/Cog_Com_Neuro_ML_DL/main?urlpath=tree/lecture/introduction/notebooks/neuroscience/mne_preprocessing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#referencing">
   1.Referencing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#artifact-detection">
   2. Artifact detection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#artifact-removal-repair">
   3. Artifact removal/repair
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering">
     3.1 Filtering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpolating-bad-channels">
     3.2 Interpolating bad channels
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpolation">
     Interpolation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#independent-component-analysis-ica">
     3.3 Independent component analysis (ICA)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#epoching">
   4. Epoching
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#epochs">
     Epochs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#events">
     Events
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-renaming-events">
     4.1 finding/renaming events
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rejecting-bad-epochs">
     4.2 rejecting bad epochs
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>EEG preprocessing with MNE</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#referencing">
   1.Referencing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#artifact-detection">
   2. Artifact detection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#artifact-removal-repair">
   3. Artifact removal/repair
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering">
     3.1 Filtering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpolating-bad-channels">
     3.2 Interpolating bad channels
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpolation">
     Interpolation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#independent-component-analysis-ica">
     3.3 Independent component analysis (ICA)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#epoching">
   4. Epoching
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#epochs">
     Epochs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#events">
     Events
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-renaming-events">
     4.1 finding/renaming events
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rejecting-bad-epochs">
     4.2 rejecting bad epochs
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="eeg-preprocessing-with-mne">
<h1>EEG preprocessing with MNE<a class="headerlink" href="#eeg-preprocessing-with-mne" title="Permalink to this headline">¶</a></h1>
<br/>
<p>Preprocessing describes the process of preparing neurophysiological data, such as the EEG data we’ll be dealing with in this chapter, for further analysis. This mainly involves removing artifacts (interference or noise due to physiological or environmental) from the recorded data, cutting out breaks in experiments, removing faulty (bad) channels and dividing the continous data into chunks centered around certain events (e.g. the presentation of a stimulus, participant’s reactions etc.). For the analysis of EEG data a few extra-steps are necessary to produce a dataset that can provide precise information about changes in neural activity or localization of involved areas, such as setting up a reference channel and applying a montage.</p>
<p><strong>For examples of possible preprocessing steps see:</strong></p>
<p><a href="https://www.frontiersin.org/articles/10.3389/fninf.2015.00016/full#h3">The PREP pipeline: standardized preprocessing for large-scale EEG analysis </a></p>
<p><a href="https://www.youtube.com/watch?v=JMB9nZNGVyk">Youtube: Overview of possible preprocessing steps (Mike Cohen)
</a></p>
<ul class="simple">
<li><p>and corresponding a whole <a href="https://mikexcohen.com/lectures.html">set of lectures for EEG data analysis (Mike Cohen)
</a></p></li>
</ul>
<p><strong>There is also an automated MNE pipeline that is continously improved</strong></p>
<a href="https://mne.tools/mne-bids-pipeline/getting_started/basic_usage.html">
MNE-BIDS-Pipeline  </a>
<br/>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>As in the previous chapter we’ll first import our necessary libraries and the <a href="https://mne.tools/stable/overview/datasets_index.html" title="https://mne.tools/stable/overview/datasets_index.html">sample dataset</a> provided by MNE.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import necessary libraries/functions</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy</span>

<span class="c1"># this allows for interactive pop-up plots</span>
<span class="c1">#%matplotlib qt</span>

<span class="c1"># allows for rendering in output-cell</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># import mne library</span>
<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne_bids</span> <span class="kn">import</span> <span class="n">BIDSPath</span><span class="p">,</span> <span class="n">write_raw_bids</span><span class="p">,</span> <span class="n">print_dir_tree</span><span class="p">,</span> <span class="n">make_report</span><span class="p">,</span> <span class="n">read_raw_bids</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load some sample data, overwrite previous data</span>
<span class="n">sample_data_folder</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span><span class="p">()</span>
<span class="n">sample_data_raw_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sample_data_folder</span><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;sample_audvis_raw.fif&#39;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span><span class="p">(</span><span class="n">sample_data_raw_file</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/michael/mne_data/MNE-sample-data/MEG/sample/sample_audvis_raw.fif...
    Read a total of 3 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
    Range : 25800 ... 192599 =     42.956 ...   320.670 secs
Ready.
Reading 0 ... 166799  =      0.000 ...   277.714 secs...
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">.</span><span class="n">info</span>  <span class="c1"># check the info object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Measurement date</th>

        <td>December 03, 2002  19:01:10 GMT</td>

    </tr>
    <tr>
        <th>Experimenter</th>

        <td>MEG</td>

    </tr>
        <th>Participant</th>

        <td>Unknown</td>

    </tr>
    <tr>
        <th>Digitized points</th>

        <td>0 points</td>

    </tr>
    <tr>
        <th>Good channels</th>
        <td>204 Gradiometers, 102 Magnetometers, 9 Stimulus, 60 EEG, 1 EOG</td>
    </tr>
    <tr>
        <th>Bad channels</th>
        <td>MEG 2443, EEG 053</td>
    </tr>
    <tr>
        <th>EOG channels</th>
        <td>EOG 061</td>
    </tr>
    <tr>
        <th>ECG channels</th>
        <td>Not available</td>

    <tr>
        <th>Sampling frequency</th>
        <td>600.61 Hz</td>
    </tr>


    <tr>
        <th>Highpass</th>
        <td>0.10 Hz</td>
    </tr>


    <tr>
        <th>Lowpass</th>
        <td>172.18 Hz</td>
    </tr>


    <tr>
        <th>Projections</th>
        <td>PCA-v1 : off<br/>PCA-v2 : off<br/>PCA-v3 : off</td>
    </tr>

</table></div></div>
</div>
<br/>
</div>
<div class="section" id="referencing">
<h2>1.Referencing<a class="headerlink" href="#referencing" title="Permalink to this headline">¶</a></h2>
<p>As the EEG is a measurement of voltage fluctuations (differences in electric potential), we will have to naturally compare the signal measured at a specific electrode to that measured at another location.</p>
<p>Therefore we’ll first define a reference channel, i.e. an electrode with which the signal of electrodes of interest can be compared. This is effecitively done by substracting the signal of the reference from our measurement electrodes. When recording EEG a specific electrode or a set of electrodes should be employed that are placed in such a way that they collect ideally all the “noise” that is also influencing our measurement electrodes at the scalp, but as little as possible of the actual neural activity of interest. Common choices for the placement of reference electrodes are the earlobes or the mastoids (the bone ridges behind the ears), although sometimes central electrodes such as Cz or FCz are chosen. If we’d be interested in the signal measuered at these sites, we would have to re-reference our data.</p>
<p>There is a few ways to go about referencing, chek-out the <a href="https://mne.tools/stable/auto_tutorials/preprocessing/55_setting_eeg_reference.html" title="https://mne.tools/stable/auto_tutorials/preprocessing/55_setting_eeg_reference.html">MNE tutorial: Setting the EEG reference</a> for more info.</p>
<p>First we’ll exclude the meg channels from our data, as we won’t be needing those for our EEG introduction. We’ll use the <a href="https://mne.tools/stable/generated/mne.pick_types.html" title="https://mne.tools/stable/generated/mne.pick_types.html">pick_types()</a> fucntion, specifying which channels to keep and which to exclude by type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Removing projector &lt;Projection | PCA-v1, active : False, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v2, active : False, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v3, active : False, n_channels : 102&gt;
</pre></div>
</div>
</div>
</div>
<br/>
<p>We can use use the <a href="https://mne.tools/stable/generated/mne.viz.plot_sensors.html" title="https://mne.tools/stable/generated/mne.viz.plot_sensors.html">.plot_sensors()</a> function to see how electrodes where placed on the scalp.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">.</span><span class="n">plot_sensors</span><span class="p">(</span><span class="n">show_names</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span> <span class="n">ch_type</span><span class="o">=</span><span class="s1">&#39;eeg&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/mne_preprocessing_12_0.png" src="../../../_images/mne_preprocessing_12_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">61</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using matplotlib as 2D backend.
Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_13_1.png" src="../../../_images/mne_preprocessing_13_1.png" />
</div>
</div>
<br/>
<p>Unfortunately the sample data wasn’t collected using one of the <a href="https://www.fieldtriptoolbox.org/getting_started/1020/" title="https://www.fieldtriptoolbox.org/getting_started/1020/">standard layouts</a> we usually see, so it is unclear if any mastoid electrodes we’re placed. Corresponding most closely to the usual positions would be the electroed “EEG 025” and “EEG 024”, therefore we’ll see how these would function as a reference channel using the <a href="https://mne.tools/stable/generated/mne.set_bipolar_reference.html" title="https://mne.tools/stable/generated/mne.set_bipolar_reference.html">mne.set_bipolar_reference()</a> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_bi_ref</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">set_bipolar_reference</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> 
                                       <span class="n">anode</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EEG 025&#39;</span><span class="p">],</span>
                                       <span class="n">cathode</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EEG 024&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EEG channel type selected for re-referencing
Creating RawArray with float64 data, n_channels=1, n_times=166800
    Range : 25800 ... 192599 =     42.956 ...   320.670 secs
Ready.
Added the following bipolar channels:
EEG 025-EEG 024
</pre></div>
</div>
</div>
</div>
<br/>
<p>and comparing the referenced data to our raw data, we’ll see that the reference channel EEG 025-EEG 024 was added in</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_bi_ref</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">61</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_17_1.png" src="../../../_images/mne_preprocessing_17_1.png" />
</div>
</div>
<br/>
<p>With the <a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.set_eeg_reference" title="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.set_eeg_reference">.set_eeg_reference()</a>  function we can also apply a virtual reference channel by averaging over all electrodes by setting the parameter to ref_channels=’average’. This will overwrite our original raw data, therefore we’ll make a <a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.copy" title="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.copy">copy()</a> of our raw object before assigning the data to a new variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the average of all channels as reference</span>
<span class="n">raw_avg_ref</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">set_eeg_reference</span><span class="p">(</span><span class="n">ref_channels</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">)</span>
<span class="n">raw_avg_ref</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_19_1.png" src="../../../_images/mne_preprocessing_19_1.png" />
</div>
</div>
<br/>
<p>We’ll be using the averaged referenced data for the next preprocessing steps, so we can get rid of the bipolar reference.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">raw_bi_ref</span>  <span class="c1"># delete the bipolar referenced data as we won&#39;t be using it</span>
</pre></div>
</div>
</div>
</div>
<br/>
</div>
<div class="section" id="artifact-detection">
<h2>2. Artifact detection<a class="headerlink" href="#artifact-detection" title="Permalink to this headline">¶</a></h2>
<p><strong>The 3 main sources of artifacts are environmental (due to power lines or electroncis), instrumentation (faulty electrodes), and biological (eye-movement, muscular activity).</strong></p>
<p>For an extensive list see the <a href="https://mne.tools/stable/auto_tutorials/preprocessing/10_preprocessing_overview.html#sphx-glr-auto-tutorials-preprocessing-10-preprocessing-overview-py" title="https://mne.tools/stable/auto_tutorials/preprocessing/10_preprocessing_overview.html#sphx-glr-auto-tutorials-preprocessing-10-preprocessing-overview-py">MNE tutorial on artifact detection</a></p>
<p>The easiest way to spot these artifacts is to simply plot the raw data if you know what you’re looking for.
For example, artifacts due to eye movement will appear as a sudden step in amplitude that persist for a while in the raw data. While artifacts due to blinking will appear as a sudden spike in amplitude that is strongest in frontal electrodes and subsides with distance to the eyes. Artifacts due to muscle activity appear as sudden bursts of high frequency activity with high amplitude in the raw data.</p>
<p>Let’s see what we can find</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_avg_ref</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_24_1.png" src="../../../_images/mne_preprocessing_24_1.png" />
</div>
</div>
<br/>
<p>Another possibility is to plot the power spectral density (PSD, i.e. the power as µV²/Hz in dB in the frequency domain) of of our signal for each channel using the <a href="https://mne.tools/stable/generated/mne.viz.plot_raw_psd.html" title="MNE API: raw.plot_psd()"> raw.plot_psd() </a> function.</p>
<p>The clear spikes in power in the 60 Hz, 120 Hz etc. frequeny range are indicative of environmental interference caused by AC power lines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_avg_ref</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eeg&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Effective window size : 3.410 (s)
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_26_1.png" src="../../../_images/mne_preprocessing_26_1.png" />
</div>
</div>
<br/>
<p>To identify artifacts automatically, we can use specific MNE functions.</p>
<p>E.g. for finding eye-movemnt artifacts due to blinks MNE provides <a href="https://mne.tools/stable/generated/mne.preprocessing.create_eog_epochs.html" title="MNE API: create_eog_epochs"> create_eog_epochs() </a> and <a href="https://mne.tools/stable/generated/mne.preprocessing.find_eog_events.html" title="MNE API: find_eog_events"> find_eog_events() </a>, which we’ll use to illustrate the mean wave-form of blinks in our data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eog_epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">create_eog_epochs</span><span class="p">(</span><span class="n">raw_avg_ref</span><span class="p">)</span>  <span class="c1"># create eog epochs</span>
<span class="n">eog_epochs</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">();</span>   <span class="c1">#  plot eog activity in source space and topography</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using EOG channel: EOG 061
EOG channel index for this subject is: [68]
Filtering the data to remove DC offset to help distinguish blinks from saccades
Setting up band-pass filter from 1 - 10 Hz

FIR filter parameters
---------------------
Designing a two-pass forward and reverse, zero-phase, non-causal bandpass filter:
- Windowed frequency-domain design (firwin2) method
- Hann window
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-12 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 10.00 Hz
- Upper transition bandwidth: 0.50 Hz (-12 dB cutoff frequency: 10.25 Hz)
- Filter length: 6007 samples (10.001 sec)

Now detecting blinks and generating corresponding events
Found 46 significant peaks
Number of EOG events detected: 46
Not setting metadata
46 matching events found
No baseline correction applied
Using data from preloaded Raw for 46 events and 601 original time points ...
0 bad epochs dropped
No projector specified for this dataset. Please consider the method self.add_proj.
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_28_1.png" src="../../../_images/mne_preprocessing_28_1.png" />
</div>
</div>
<br/>
<p><strong>Bad channels are most easliy identified by  visual inspection:</strong>
Does the signal captured by an electrode look significantly different in relation to surrounding channels? E.g. a completly flat line, high variability (i.e. appear “noisy”) or slow amplitude “drifts” over prolonged timespans. Calling the .plot() function allows us to mark channels that appear problematic by simply clicking on them, which will add them to a list object containing info on all channels marked as bad.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_avg_ref</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_30_1.png" src="../../../_images/mne_preprocessing_30_1.png" />
</div>
</div>
<br/>
<p>For a more automatic approach we can identify bad channels if the contained signal exceeds a certain deviation threshold by calculating the median absolute deviation of the signal in each channel compared to the others (check <a href="https://cloudxlab.com/assessment/displayslide/6286/robust-z-score-method" title="https://cloudxlab.com/assessment/displayslide/6286/robust-z-score-method">robust-z-score-method</a> for more info).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">channel</span> <span class="o">=</span> <span class="n">raw_avg_ref</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ch_names&#39;</span><span class="p">]</span>  <span class="c1"># get list of eeg channel names</span>
<span class="n">data_</span> <span class="o">=</span> <span class="n">raw_avg_ref</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1e6</span>  <span class="c1"># * 1e6 to transform to microvolt</span>

<span class="c1"># calculate median absolute deviation for each channel</span>
<span class="n">mad_scores</span> <span class="o">=</span><span class="p">[</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">median_abs_deviation</span><span class="p">(</span><span class="n">data_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

<span class="c1"># compute z-scores for each channel</span>
<span class="n">z_scores</span> <span class="o">=</span> <span class="mf">0.6745</span> <span class="o">*</span> <span class="p">(</span><span class="n">mad_scores</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">mad_scores</span><span class="p">))</span> <span class="o">/</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">median_abs_deviation</span><span class="p">(</span><span class="n">mad_scores</span><span class="p">,</span> 
                                                                                                <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># 1/1.4826=0.6745 (scale factor for MAD for non-normal distribution) </span>

<span class="nb">print</span><span class="p">(</span><span class="n">z_scores</span><span class="p">)</span>
<span class="c1"># get channel containing outliers </span>
<span class="n">bad_dev</span> <span class="o">=</span> <span class="p">[</span><span class="n">channel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z_scores</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">3.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bad_dev</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 2.93167008  1.86691661  2.09310209  4.53669083  1.7094114   1.91507927
  3.42109942  3.10263133  1.15765809  3.55407866  0.03090902  0.
  0.07612489  0.62614561  3.10922774  1.1404617   0.14003354  1.39446589
  0.32007086 -0.89047971 -0.67367991 -0.04997815  1.60603094  0.71714524
  2.01475609  0.04695926 -1.01900083 -1.02329586 -0.5332095   0.12645023
 -0.88577349 -1.09949559 -1.09459968  0.67719062 -0.10036744  1.20170778
  0.39599687 -0.44442974 -0.83317981 -1.04410547 -0.71924608 -1.02629246
 -0.36268423 -0.01897108 -0.5094786   0.95862707 -0.6745      0.57131944
 -0.35042718 -0.36892057 -0.34527809 -0.52673014 -0.15169144 -0.46104639
 -0.31247056 -0.20796368 -0.42393661 -0.05808648  0.47628818]
[&#39;EEG 004&#39;, &#39;EEG 007&#39;, &#39;EEG 008&#39;, &#39;EEG 010&#39;, &#39;EEG 015&#39;]
</pre></div>
</div>
</div>
</div>
<br/>
</div>
<div class="section" id="artifact-removal-repair">
<h2>3. Artifact removal/repair<a class="headerlink" href="#artifact-removal-repair" title="Permalink to this headline">¶</a></h2>
<p>Next we’ll try to eliminate and or repair the previously identified artifacts with using different methods (frequency-filtering, rejecting bad channels and Independent component analysis). It is important to note that not all artifacts are problematic or should necessarily lead to complete data rejection, so we’ll try to retain as much signal as possible by removing the contaminated signal component and estimating the true signal we’d record if the specific artifacts where not present.</p>
<p>For a primer on how to decide which artifacts should be removed/not removed see <a href="https://www.youtube.com/watch?v=VDqwfP0mlfU" title="https://www.youtube.com/watch?v=VDqwfP0mlfU">Youtube: Signal artifacts (not) to worry about</a>.</p>
<br/>
<div class="section" id="filtering">
<h3>3.1 Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h3>
<p>Line noise and slow drifts are most easily dealt with by <strong>applying a filter to our data that artifically removes any activity above (highpass) or below (lowpass) a certain frequency</strong>. As the range of frequency that is actually relevant for our data or plausibly produced by neural activity is rather limited, we can for example get rid of the above identified line noise artifacts quite easily by setting a cut-off frequency (lowpass-filter) for our data somewhere below 60Hz.</p>
<p>There is extensive literature on and a plethora off methods to consider when it comes to eeg-filters, but for this tutorial we’ll be using the mne standard parameters. For more info on eeg-filters see the <a href="https://mne.tools/stable/auto_tutorials/preprocessing/25_background_filtering.html" title="MNE: background on filtering">MNE: background on filtering</a> or for a visual approach <a href="https://www.youtube.com/watch?v=2tmilbi4L0o" title="Youtube: FIR Filter Design using the Window Method">Youtube: FIR Filter Design using the Window Method</a>.</p>
<p><strong>We’ll be setting a highpass filter at 0.1hz (to get rid of slow drifts in electrode conductance over time) and a low-pass filter of 40hz (to get rid of electrical line noise).</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_filtered</span> <span class="o">=</span> <span class="n">raw_avg_ref</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">l_freq</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">h_freq</span><span class="o">=</span><span class="mf">40.</span><span class="p">,</span>  <span class="c1"># lfreq = lower cut-off frequency; hfreq =upper cut-off frequency</span>
                 <span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eeg&#39;</span><span class="p">,</span> <span class="s1">&#39;eog&#39;</span><span class="p">],</span>  <span class="c1"># which channel to filter by type</span>
                 <span class="n">filter_length</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                 <span class="n">l_trans_bandwidth</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                 <span class="n">h_trans_bandwidth</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                 <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fir&#39;</span><span class="p">,</span>  <span class="c1"># finite response filter; MNE default</span>
                 <span class="n">phase</span><span class="o">=</span><span class="s1">&#39;zero&#39;</span><span class="p">,</span>
                 <span class="n">fir_window</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">,</span>  <span class="c1"># i.e. our &quot;smoothing function&quot; (MNE-default)</span>
                 <span class="n">fir_design</span><span class="o">=</span><span class="s1">&#39;firwin&#39;</span><span class="p">,</span>
                 <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 19821 samples (33.001 sec)
</pre></div>
</div>
</div>
</div>
<br/>
<p>Comparing the filtered data in the time domain shows that we got rid of a lot of the “noisiness” present in the individual channels, as well as attentuated some of the high-frequency muscle artifacts. Ocular artifacts are still clearly present.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_39_1.png" src="../../../_images/mne_preprocessing_39_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_40_1.png" src="../../../_images/mne_preprocessing_40_1.png" />
</div>
</div>
<br/>
<p>Comparing the power spectral density plots of our filtered and unfiltered data revals that frequencies above the specifed cut-off are basically eliminated from our data. The power-spectral density plot further illustrates that there is a certain drop-off range called the <strong>transition band</strong>, which in this case is about 10Hz after the specified cut-off frequency pf 40Hz</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># unfiltered power spectral density (PSD)</span>
<span class="n">raw_avg_ref</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Effective window size : 3.410 (s)
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_42_1.png" src="../../../_images/mne_preprocessing_42_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># filtered power spectral density (PSD)</span>
<span class="n">raw_filtered</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Effective window size : 3.410 (s)
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_43_1.png" src="../../../_images/mne_preprocessing_43_1.png" />
</div>
</div>
<br/>
</div>
<div class="section" id="interpolating-bad-channels">
<h3>3.2 Interpolating bad channels<a class="headerlink" href="#interpolating-bad-channels" title="Permalink to this headline">¶</a></h3>
<p>Let’s first take a look at the previoulsly marked bad channels for our unfiltered data again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bad_dev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;EEG 004&#39;, &#39;EEG 007&#39;, &#39;EEG 008&#39;, &#39;EEG 010&#39;, &#39;EEG 015&#39;]
</pre></div>
</div>
</div>
</div>
<br/>
<p>Next we calculate the median absolute deviations again, but this time for the filtered data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">channel</span> <span class="o">=</span> <span class="n">raw_filtered</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ch_names&#39;</span><span class="p">]</span>  <span class="c1"># get list of eeg channel names</span>
<span class="n">data_</span> <span class="o">=</span> <span class="n">raw_filtered</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1e6</span>  <span class="c1"># * 1e6 to transform to microvolt</span>

<span class="c1"># calculate median absolute deviation for each channel</span>
<span class="n">mad_scores</span> <span class="o">=</span><span class="p">[</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">median_abs_deviation</span><span class="p">(</span><span class="n">data_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

<span class="c1"># compute z-scores for each channel</span>
<span class="n">z_scores</span> <span class="o">=</span> <span class="mf">0.6745</span> <span class="o">*</span> <span class="p">(</span><span class="n">mad_scores</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">mad_scores</span><span class="p">))</span> <span class="o">/</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">median_abs_deviation</span><span class="p">(</span><span class="n">mad_scores</span><span class="p">,</span> 
                                                                                                <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># 1/1.4826=0.6745 (scale factor for MAD for non-normal distribution) </span>

<span class="nb">print</span><span class="p">(</span><span class="n">z_scores</span><span class="p">)</span>
<span class="c1"># get channel containing outliers </span>
<span class="n">bad_dev</span> <span class="o">=</span> <span class="p">[</span><span class="n">channel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z_scores</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">3.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bad_dev</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 2.53491522  1.73967805  2.30066055  3.08832218  1.66155918  1.85743653
  3.14194962  2.46251724  0.90603823  2.26484445  0.06479951  0.29247788
  0.3325463   0.70652085  2.51787841  0.89403503  0.          0.6745
 -0.35824365 -0.8605855  -0.59368432 -0.37479054  0.91453675  0.47206722
  2.17453196 -0.48878472 -1.20579555 -1.04112896 -0.72032546  0.16183855
 -0.85172137 -1.05013466 -1.09402637  0.03657005 -0.04724789  1.38467332
 -0.13037815 -0.68966154 -0.91377994 -0.95780618 -0.82304069 -1.00630492
 -0.32368758  0.08028723 -0.43569248  0.97852603 -0.60128033  0.40168626
 -0.35229997 -0.32971686 -0.26989682 -0.55193517  0.05454042 -0.25843797
 -0.10949953 -0.04371482 -0.23934103  0.13879019  0.16710858]
[&#39;EEG 004&#39;, &#39;EEG 007&#39;]
</pre></div>
</div>
</div>
</div>
<br/>
Now we see that only 2 out of 5 channels are considered to be outliers. So it appears that our filter got rid of some of the problematic noise in our channels already. We'll check if there is already info about bad channels in the metadata of our raw object, that the experimenters may have already provide. Information on which channels are bad is stored in the .info object. <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
</div>
</div>
<br/>
<p>Adding our outlier channels to the list of “bad” channesl basically means that we declare that these channels should not be considered for further analysis.</p>
<p>As .info[‘bads’] is a regular python list we can edit it in a few simple ways, e.g. let’s say electrode EEG 007 would look wildly out of place compared to the signal in the surrounding electrodes. Now e.g. we can add entries using .append() to our list</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;EEG 007&#39;</span><span class="p">)</span>               <span class="c1"># add bad channel</span>
<span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;EEG 007&#39;]
</pre></div>
</div>
</div>
</div>
<br/>
remove entries via .pop<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># remove last entry</span>
<span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
</div>
</div>
<br/>
and add multiple values to our list of bads or even completly replace our list of bad channels.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">old_bads</span> <span class="o">=</span> <span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span> <span class="c1"># create variable containing original bad channels</span>
<span class="n">new_bads</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;EEG 008&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG 009&#39;</span><span class="p">]</span>  <span class="c1"># create list of channels to add</span>

<span class="c1"># overwrite the whole list</span>
<span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_bads</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">])</span>

<span class="c1"># or combine old an new list of bad channels</span>
<span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_bads</span> <span class="o">+</span> <span class="n">new_bads</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;EEG 008&#39;, &#39;EEG 009&#39;]
[&#39;EEG 008&#39;, &#39;EEG 009&#39;]
</pre></div>
</div>
</div>
</div>
<br/>
Let's empty our list of bad channels for now<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># set empty list</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
</div>
</div>
<p>and add the outlier channels we’ve identified above</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bad_dev</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;EEG 004&#39;, &#39;EEG 007&#39;]
</pre></div>
</div>
</div>
</div>
<br/>
taking a look at the "Bad channels" row of the .info reveals that the marked channels are now part of the raw objects metadata.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Measurement date</th>

        <td>December 03, 2002  19:01:10 GMT</td>

    </tr>
    <tr>
        <th>Experimenter</th>

        <td>MEG</td>

    </tr>
        <th>Participant</th>

        <td>Unknown</td>

    </tr>
    <tr>
        <th>Digitized points</th>

        <td>0 points</td>

    </tr>
    <tr>
        <th>Good channels</th>
        <td>9 Stimulus, 59 EEG, 1 EOG</td>
    </tr>
    <tr>
        <th>Bad channels</th>
        <td>EEG 004, EEG 007</td>
    </tr>
    <tr>
        <th>EOG channels</th>
        <td>EOG 061</td>
    </tr>
    <tr>
        <th>ECG channels</th>
        <td>Not available</td>

    <tr>
        <th>Sampling frequency</th>
        <td>600.61 Hz</td>
    </tr>


    <tr>
        <th>Highpass</th>
        <td>0.10 Hz</td>
    </tr>


    <tr>
        <th>Lowpass</th>
        <td>40.00 Hz</td>
    </tr>


</table></div></div>
</div>
<br/>
</div>
<div class="section" id="interpolation">
<h3>Interpolation<a class="headerlink" href="#interpolation" title="Permalink to this headline">¶</a></h3>
<p>Now that we know which channels are problematic, we can <strong>estimate their actual signal given the signal of the surrounding electrodes</strong> via the <a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.interpolate_bads" title="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.interpolate_bads">.interpolate_bads()</a> fucntion, as with the relatively poor spatial resolution it is highly unklikey that one electrode would have picked up a signal that is not also to a to lesser degree present in the surrounding electrodes. This concept is illustrated well in the visualizatio of the topopgraphic spread of evoked potentials <a href="https://mne.tools/stable/auto_examples/visualization/topo_compare_conditions.html" title="https://mne.tools/stable/auto_examples/visualization/topo_compare_conditions.html">here</a>. See the <a href="https://mne.tools/stable/auto_examples/preprocessing/interpolate_bad_channels.html#footcite-perrinetal1989" title="MNE tutorial: interpolate bad channels"> MNE tutorial: interpolate bad channels </a> for more on the implementation and the therein cited papers for the technical information.</p>
<p>When to interpolate or drop bad channels should be decided on an individual basis. In general, <strong>if the signal picked up is consistently bad/noisy and might influence the overall quality of the data the channel can be interpolated</strong>. If there are only single “ariftact events in” the channel it’s best to keep the channel and later on exclude the epoch containing the artifact. For automatization purposes you’ll of course have to make an a priori decison on what levels of noise e.g. you’re willing to accept.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;EEG 004&#39;, &#39;EEG 007&#39;]
</pre></div>
</div>
</div>
</div>
<br/>
<p>For ilustrative purposes we’ll interpolate the channels we’ve identified as outliners above and compare the data before and after interpolation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interp_</span> <span class="o">=</span> <span class="n">raw_filtered</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">interpolate_bads</span><span class="p">(</span><span class="n">reset_bads</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># copy() as this would modify the raw object in place</span>
<span class="n">interp_</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Interpolating bad channels
    Automatic origin fit: head of radius 91.0 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 2 sensors
Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_67_1.png" src="../../../_images/mne_preprocessing_67_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_68_1.png" src="../../../_images/mne_preprocessing_68_1.png" />
</div>
</div>
<br/>
We see a reduction in the amplitude of the high frequency components in the channels "EEG 004" and "EEG 007", as well as an general "reshaping" of the data as a composition of activity in the surrounding channels. A prominent example would be the change in wave-form for the first blink-artifact in channel "EEG 004".<p>Let’s apply this to our data and reset our bad channels, so that they’ll not be excluded from further analysis anymore.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">interpolate_bads</span><span class="p">(</span><span class="n">reset_bads</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Interpolating bad channels
    Automatic origin fit: head of radius 91.0 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 2 sensors
</pre></div>
</div>
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Measurement date</th>

        <td>December 03, 2002  19:01:10 GMT</td>

    </tr>
    <tr>
        <th>Experimenter</th>

        <td>MEG</td>

    </tr>
        <th>Participant</th>

        <td>Unknown</td>

    </tr>
    <tr>
        <th>Digitized points</th>

        <td>0 points</td>

    </tr>
    <tr>
        <th>Good channels</th>
        <td>9 Stimulus, 59 EEG, 1 EOG</td>
    </tr>
    <tr>
        <th>Bad channels</th>
        <td>None</td>
    </tr>
    <tr>
        <th>EOG channels</th>
        <td>EOG 061</td>
    </tr>
    <tr>
        <th>ECG channels</th>
        <td>Not available</td>

    <tr>
        <th>Sampling frequency</th>
        <td>600.61 Hz</td>
    </tr>


    <tr>
        <th>Highpass</th>
        <td>0.10 Hz</td>
    </tr>


    <tr>
        <th>Lowpass</th>
        <td>40.00 Hz</td>
    </tr>



    <tr>
        <th>Filenames</th>
        <td>sample_audvis_raw.fif</td>
    </tr>

    <tr>
        <th>Duration</th>
        <td>00:04:37 (HH:MM:SS)</td>
    </tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">interp_</span> <span class="c1"># delete to free up space</span>
</pre></div>
</div>
</div>
</div>
<br/>
</div>
<div class="section" id="independent-component-analysis-ica">
<h3>3.3 Independent component analysis (ICA)<a class="headerlink" href="#independent-component-analysis-ica" title="Permalink to this headline">¶</a></h3>
<p><strong>One of the most common and effetive tools for artifact detection and removal is the Independent component analysis, which we’ll use to exclude our occular artifacts from the data in the next step</strong></p>
<p>In brief:
ICA is a technique for signal processing that separates a signal into a specified number of linearly mixed sources. For the preprocessing of EEG data this is  used to find statistically independet sources of signal variability present in our n_channel dimensional data. EEG artifacts are usually strong sources of variability as they show higher amplitude than would be expected for sources of neural activity and generally appear more consistent than fluctuating neural activity, best illustrated by occular artifacts, and can therefore be easily identified via ICA.</p>
<p><strong>An ICA is performed in multiply steps:</strong></p>
<ol class="simple">
<li><p>Specify the ICA algorithm/paramertes:</p>
<ul class="simple">
<li><p>n_components = the number of components we want to decompose our signal in. The more components one includes the more accurate the ICA solution becomes, i.e. the finer grained your sources of variability will be identified in the specific components.</p></li>
<li><p>max_iter = the number of iterations for approximation (see <a href="https://en.wikipedia.org/wiki/Iterative_method" title="https://en.wikipedia.org/wiki/Iterative_method">Wikipedia: iterative processes</a> for more)</p></li>
<li><p>random_state = identifier for the initial value/decomposition matrix used (as ICA is non-deterministic this is necessary to reproduce the same output when repeating the ICA)</p></li>
<li><p>method = the ICA algorithm to use, defaults to “fastica”. Choice of algorithm usually boils down to computational speed vs. maximization of information (see the <a href="https://mne.tools/stable/generated/mne.preprocessing.ICA.html#mne.preprocessing.ICA" title="https://mne.tools/stable/generated/mne.preprocessing.ICA.html#mne.preprocessing.ICA">MNE API: preprocessing.ICA</a> for more  information)</p></li>
</ul>
</li>
<li><p>Fit the ICA to the data/Identify ICA components</p>
<ul class="simple">
<li><p>visualize your component solution, i.e artifact detection</p></li>
<li><p>for an introductionary tutorials to identifying ICA components in eeg see <a href="https://labeling.ucsd.edu/tutorial/labels" title="ICLabel Tutorial: EEG Independent Component Labeling">ICLabel Tutorial: EEG Independent Component Labeling </a></p></li>
</ul>
</li>
<li><p>Specify which components should be removed from the data</p></li>
<li><p>Reconstructing the Signal, i.e. apply the ICA solution with the components containing artifacts excluded from the data
<br/></p></li>
</ol>
<p><strong>Further reading</strong></p>
<p>For more theory on the ICA and how it’s used in MNE etc. see the <a href="https://mne.tools/stable/auto_tutorials/preprocessing/40_artifact_correction_ica.html" title="MNE tutorial: artifact correction via ica"> MNE tutorial: artifact correction via ica </a> and  <a href="https://scikit-learn.org/stable/auto_examples/decomposition/plot_ica_blind_source_separation.html#sphx-glr-auto-examples-decomposition-plot-ica-blind-source-separation-py" title="Scikit-learn example: ica blind source separation">Scikit-learn example: ica blind source separation </a></p>
<p>For more general explanations on ICA for EEG data, what to look for, which artifacts to include etc., see the video <a href="https://www.youtube.com/watch?v=kWAjhXr7pT4&list=PLXc9qfVbMMN2uDadxZ_OEsHjzcRtlLNxc" title="Youtube: Independent components analysis for removing artifacts by Mike X Cohen"> Independent components analysis for removing artifacts by Mike X Cohen</a> or the video series on <a href="https://www.youtube.com/watch?v=kWAjhXr7pT4&list=PLXc9qfVbMMN2uDadxZ_OEsHjzcRtlLNxc" title="Youtube: ICA applied to EEG time series by Arnaud Delorme"> ICA applied to EEG time series by Arnaud Delorme</a>.</p>
<p>For this tutorial we’ll be excluding ICA components by hand (or eye), but to remove researcher bias and allow for analysis of larger sample sizes we could also employ ica templates based on certain common artifacts and automate this process. See <a href="https://mne.tools/stable/auto_tutorials/preprocessing/40_artifact_correction_ica.html#selecting-ica-components-using-template-matching" title="MNE tutorial: selecting ica components using template matching">MNE tutorial: selecting ica components using template matching </a> for more info.</p>
<br/>
<p><strong>1. Specify the ICA algorithm/paramertes:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">ICA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                            <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                            <span class="n">max_iter</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> 
                            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;infomax&#39;</span><span class="p">)</span>  <span class="c1"># set-up ICA parameters</span>
</pre></div>
</div>
</div>
</div>
<br/>
<p><strong>2. Fit the ICA to the data/Identify ICA components</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ICA_solution</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">raw_filtered</span><span class="p">)</span>  <span class="c1"># fit the ICA to our data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
 
Fitting ICA took 16.7s.
</pre></div>
</div>
</div>
</div>
<br/>
<p><strong>Now we have a number of ways for visualizing the identified sources of variability.</strong></p>
<p>We can plot the ICA componets as a projection on the sensor topography, to see where the variability in our signal is located in sensor space. E.g. occular activiy should be located over frontal electrodes, like in component ICA 000 and component ICA 003</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_components</span><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">));</span>  <span class="c1"># visualize our components</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/mne_preprocessing_80_0.png" src="../../../_images/mne_preprocessing_80_0.png" />
</div>
</div>
<br/>
<p>Another way to visualize our ICA solution and one of the easiest ways to understand what patterns of variability in our data an ICA component captures, is to visualize the components in source space, i.e. how do the components represent latent sources of signal variability over time.
See <a href="https://mne.tools/stable/generated/mne.preprocessing.ICA.html#mne.preprocessing.ICA.plot_sources" title="MNE API: plot_sources()">MNE API: plot_sources() </a> for more info.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_sources</span><span class="p">(</span><span class="n">raw_filtered</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Creating RawArray with float64 data, n_channels=21, n_times=166800
    Range : 25800 ... 192599 =     42.956 ...   320.670 secs
Ready.
Opening ica-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_82_1.png" src="../../../_images/mne_preprocessing_82_1.png" />
</div>
</div>
<br/>
You can scroll through the plot_sources() output (if opened via binder or jupyter notebooks/lab) and compare it with the topographical map above, to see if you can spot some more artifcats or if you can identify genuine sources of neural activity.
<p>Here we see that the first component (ICA 000) appears to capture our blink artifacts, while the later parts of ICA 003 appears to be indicative of horizontal eye movement. The topographical location of these artifacts in the plot above points towards the same intepretation. ICA 11 and ICA 18 additionaly appear to capture some weird artifacts, possibly due to channel noise or electrical interference.</p>
<p>To visualize what would happen to our signal if we were to extract these components, we can use the  <a href="https://mne.tools/stable/generated/mne.preprocessing.ICA.html#mne.preprocessing.ICA.plot_overlay" title="MNE API: plot_overlay()">plot_overlay() </a> function and pass the problematic ica components by their index as arguments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_overlay</span><span class="p">(</span><span class="n">raw_filtered</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 59 PCA components
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_85_1.png" src="../../../_images/mne_preprocessing_85_1.png" />
</div>
</div>
<br/>
<p>And it appears that the exclusion of the two components results in the elimination of the blink artifacts.</p>
<p><em>Note of caution: It’s generally advised not to exclude components if you’re not certain that they may contain artifacts. Adjustments for artifcats that are only present in a small subset of all events (e.g. presented stimuli) can still be made later by excluding the affected epochs. So we’ll stick with the exclusion of these 2 components for now.</em></p>
<br/>
<p><strong>3. Specify which components you want to remove from the data</strong></p>
<p>We’ll add the components we want to exclude from our data to the ica.exlude object (which can be done the same way as we did above withe <a class="reference external" href="http://raw.info">raw.info</a>[bads] list), create a copy of our filtered data (as to not modify it in place) and apply the ica solution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># apply ica to data</span>
<span class="n">ica</span><span class="o">.</span><span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<br/>
<p><strong>4. Reconstructing the Signal</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reconst_sig</span> <span class="o">=</span> <span class="n">raw_filtered</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>
<span class="n">ica</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">reconst_sig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 59 PCA components
</pre></div>
</div>
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Measurement date</th>

        <td>December 03, 2002  19:01:10 GMT</td>

    </tr>
    <tr>
        <th>Experimenter</th>

        <td>MEG</td>

    </tr>
        <th>Participant</th>

        <td>Unknown</td>

    </tr>
    <tr>
        <th>Digitized points</th>

        <td>0 points</td>

    </tr>
    <tr>
        <th>Good channels</th>
        <td>59 EEG</td>
    </tr>
    <tr>
        <th>Bad channels</th>
        <td>None</td>
    </tr>
    <tr>
        <th>EOG channels</th>
        <td>Not available</td>
    </tr>
    <tr>
        <th>ECG channels</th>
        <td>Not available</td>

    <tr>
        <th>Sampling frequency</th>
        <td>600.61 Hz</td>
    </tr>


    <tr>
        <th>Highpass</th>
        <td>0.10 Hz</td>
    </tr>


    <tr>
        <th>Lowpass</th>
        <td>40.00 Hz</td>
    </tr>



    <tr>
        <th>Filenames</th>
        <td>sample_audvis_raw.fif</td>
    </tr>

    <tr>
        <th>Duration</th>
        <td>00:04:37 (HH:MM:SS)</td>
    </tr>
</table></div></div>
</div>
<br/>
<p><strong>And lastly comparing our ICA reconstructed signal to the filtered data, it seems that we got rid of most ocular artifacts.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_filtered</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_93_1.png" src="../../../_images/mne_preprocessing_93_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reconst_sig</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_94_1.png" src="../../../_images/mne_preprocessing_94_1.png" />
</div>
</div>
<br/>
<p>To free up space we get rid of the filtered data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">raw_filtered</span>
</pre></div>
</div>
</div>
</div>
<br/>
<p><strong>Now we can save the preprocessed data for further processing.</strong></p>
<p>Let’s first get our paths in order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">homedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>  <span class="c1"># find home diretory</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="p">(</span><span class="n">homedir</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;msc_05_example_bids_dataset&#39;</span> <span class="o">+</span> 
               <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;sub-test&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;ses-001&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;meg&#39;</span><span class="p">)</span>
                         

<span class="nb">print</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/michael/msc_05_example_bids_dataset/sub-test/ses-001/meg
</pre></div>
</div>
</div>
</div>
<br/>
<p>and save again using the  <a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.save" title="MNE API: mne.raw.save()"> raw.save() </a> function.**</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reconst_sig</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_path</span> <span class="o">+</span> <span class="p">((</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span> <span class="o">+</span>
                                <span class="s1">&#39;sub-test_ses-001_sample_audiovis_eeg_data_preprocessed.fif&#39;</span><span class="p">),</span>  <span class="c1"># the filename</span>
         <span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eeg&#39;</span><span class="p">,</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span> <span class="s1">&#39;stim&#39;</span><span class="p">],</span>  <span class="c1"># the channels to pick (could also be single channels)</span>
         <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># checks if data is already present and overwrites if true</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing /home/michael/msc_05_example_bids_dataset/sub-test/ses-001/meg/sub-test_ses-001_sample_audiovis_eeg_data_preprocessed.fif
Closing /home/michael/msc_05_example_bids_dataset/sub-test/ses-001/meg/sub-test_ses-001_sample_audiovis_eeg_data_preprocessed.fif
[done]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_29153/2232610041.py:4: RuntimeWarning: This filename (/home/michael/msc_05_example_bids_dataset/sub-test/ses-001/meg/sub-test_ses-001_sample_audiovis_eeg_data_preprocessed.fif) does not conform to MNE naming conventions. All raw files should end with raw.fif, raw_sss.fif, raw_tsss.fif, _meg.fif, _eeg.fif, _ieeg.fif, raw.fif.gz, raw_sss.fif.gz, raw_tsss.fif.gz, _meg.fif.gz, _eeg.fif.gz or _ieeg.fif.gz
  overwrite=True)  # checks if data is already present and overwrites if true
</pre></div>
</div>
</div>
</div>
<br/>
<p><strong>Other techniques for artifact detection/repair?</strong></p>
<p>For an overview of other techniques for preprocessing you can follow these MNE tutorials:</p>
<p><a href="https://mne.tools/stable/auto_tutorials/preprocessing/50_artifact_correction_ssp.html" title="https://mne.tools/stable/auto_tutorials/preprocessing/50_artifact_correction_ssp.html">MNE tutorial: Repairing artifacts with Signal-space projection (SSP)</a></p>
<p><a href="https://mne.tools/stable/auto_tutorials/preprocessing/60_maxwell_filtering_sss.html" title="https://mne.tools/stable/auto_tutorials/preprocessing/60_maxwell_filtering_sss.html">MNE tutorial: Signal-space separation (SSS) and Maxwell filtering</a></p>
<p><a href="https://www.youtube.com/watch?v=6njzcZWuh9Q&list=PLn0OLiymPak2gDD-VDA90w9_iGDgOOb2o" title="https://www.youtube.com/watch?v=6njzcZWuh9Q&list=PLn0OLiymPak2gDD-VDA90w9_iGDgOOb2o">MNE tutorial: Surface Laplacian for cleaning, topoplogical localization, and connectivity</a></p>
<br/>
<br/>
</div>
</div>
<div class="section" id="epoching">
<h2>4. Epoching<a class="headerlink" href="#epoching" title="Permalink to this headline">¶</a></h2>
<div class="section" id="epochs">
<h3>Epochs<a class="headerlink" href="#epochs" title="Permalink to this headline">¶</a></h3>
<p>Epochs represent <strong>chunks of continous eeg data time-locked to certain events or periods of activity</strong> (e.g. experimental blocks). They are usually equal length and should contain enough time before an  event to allow for baseline correction and enough time after the stimulus to catch all possible activity (evoked/event-related potentials or changes in frequency band) of interest for later analysis.</p>
<p>The mne.Epochs objects can be treated the same as the previous raw objects in a number of ways, including the .info() manipulations we</p>
<p><strong>To create our epochs we  need two things:</strong>
- raw or preprocessed data
- events</p>
<p>For more info on the Epochs data structure see the <a href="https://mne.tools/stable/auto_tutorials/epochs/10_epochs_overview.html#sphx-glr-auto-tutorials-epochs-10-epochs-overview-py" title="MNE tutorial: The Epochs data structure: discontinuous data)">MNE tutorial: The Epochs data structure: discontinuous data</a></p>
</div>
<div class="section" id="events">
<h3>Events<a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h3>
<p>Events in the context of this tutorial are <strong>flags indicating that at a certain time the presentation of a stimulus or a participant’s reaction has occured</strong>. Event IDs indicate what kind of condition was recorded, usually they are stored as simple integers.</p>
<p>Information on what kind of stimulus/reaction was recorded is in general stored in the “Stim” channels or the metadata of the raw object (check <a class="reference external" href="http://raw.info">raw.info</a>[‘events’]). Otherwise, if the Data is organized in the BIDS format, you can check the “_events.tsv” file in the subject folder and for the possible descriptions of the contained event-identifiers the “dataset_description.json” or the “README.txt”. Some systems save events in a separate annotation file (e.g. eeglab set files), for which mne provides a dedicated function to convert these files to an event array. See <a href="https://mne.tools/stable/auto_tutorials/intro/20_events_from_raw.html" title="https://mne.tools/stable/auto_tutorials/intro/20_events_from_raw.html">MNE tutorial: Parsing events from raw data</a> for more info.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reconst_sig</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;events&#39;</span><span class="p">]</span>  <span class="c1"># check if info on events is contained in raw object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;channels&#39;: array([307, 308, 309, 310, 311, 312, 313, 314, 315], dtype=int32),
  &#39;list&#39;: array([ 16422,      0,     64, ..., 168680,     32,      0], dtype=int32)}]
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;ch_names&#39;</span><span class="p">]</span>  <span class="c1"># see if stim_channel are found in the raw object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;STI 001&#39;,
 &#39;STI 002&#39;,
 &#39;STI 003&#39;,
 &#39;STI 004&#39;,
 &#39;STI 005&#39;,
 &#39;STI 006&#39;,
 &#39;STI 014&#39;,
 &#39;STI 015&#39;,
 &#39;STI 016&#39;,
 &#39;EEG 001&#39;,
 &#39;EEG 002&#39;,
 &#39;EEG 003&#39;,
 &#39;EEG 004&#39;,
 &#39;EEG 005&#39;,
 &#39;EEG 006&#39;,
 &#39;EEG 007&#39;,
 &#39;EEG 008&#39;,
 &#39;EEG 009&#39;,
 &#39;EEG 010&#39;,
 &#39;EEG 011&#39;,
 &#39;EEG 012&#39;,
 &#39;EEG 013&#39;,
 &#39;EEG 014&#39;,
 &#39;EEG 015&#39;,
 &#39;EEG 016&#39;,
 &#39;EEG 017&#39;,
 &#39;EEG 018&#39;,
 &#39;EEG 019&#39;,
 &#39;EEG 020&#39;,
 &#39;EEG 021&#39;,
 &#39;EEG 022&#39;,
 &#39;EEG 023&#39;,
 &#39;EEG 024&#39;,
 &#39;EEG 025&#39;,
 &#39;EEG 026&#39;,
 &#39;EEG 027&#39;,
 &#39;EEG 028&#39;,
 &#39;EEG 029&#39;,
 &#39;EEG 030&#39;,
 &#39;EEG 031&#39;,
 &#39;EEG 032&#39;,
 &#39;EEG 033&#39;,
 &#39;EEG 034&#39;,
 &#39;EEG 035&#39;,
 &#39;EEG 036&#39;,
 &#39;EEG 037&#39;,
 &#39;EEG 038&#39;,
 &#39;EEG 039&#39;,
 &#39;EEG 040&#39;,
 &#39;EEG 041&#39;,
 &#39;EEG 042&#39;,
 &#39;EEG 043&#39;,
 &#39;EEG 044&#39;,
 &#39;EEG 045&#39;,
 &#39;EEG 046&#39;,
 &#39;EEG 047&#39;,
 &#39;EEG 048&#39;,
 &#39;EEG 049&#39;,
 &#39;EEG 050&#39;,
 &#39;EEG 051&#39;,
 &#39;EEG 052&#39;,
 &#39;EEG 054&#39;,
 &#39;EEG 055&#39;,
 &#39;EEG 056&#39;,
 &#39;EEG 057&#39;,
 &#39;EEG 058&#39;,
 &#39;EEG 059&#39;,
 &#39;EEG 060&#39;,
 &#39;EOG 061&#39;]
</pre></div>
</div>
</div>
</div>
<br/>
</div>
<div class="section" id="finding-renaming-events">
<h3>4.1 finding/renaming events<a class="headerlink" href="#finding-renaming-events" title="Permalink to this headline">¶</a></h3>
<p>To find the events in the raw file we can usually use <a href="https://mne.tools/stable/generated/mne.find_events.html">find_events()</a> function on our raw object. This function automatically checks if there are Stim channel present in the data. Stimulus channel do not collect EEG data, but the triggers associated with events that an experiment may contain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>320 events found
Event IDs: [ 1  2  3  4  5 32]
</pre></div>
</div>
</div>
</div>
<br/>
<p>We ca visualize these stimulus channel using the <a href="https://mne.tools/stable/generated/mne.pick_types.html" title="https://mne.tools/stable/generated/mne.pick_types.html">.pick_types()</a> function on our raw when we sett the “stim” parameter to true.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>  <span class="c1"># copy as to not modify our data in place</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_112_1.png" src="../../../_images/mne_preprocessing_112_1.png" />
</div>
</div>
<br/>
<p>Looking at these channels it becomes obvious that “STI 014” contains all relevant events contained in the other stimuli channel and encodes them by variations in amplitude. Therefore explicitly picking the events from this channel leads to the same result as the function above.</p>
<p>Looking at the other stim channels reveals that they each contain only a single kind of event. E.g. “STI 002” contains only the event with the ID “5”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 002&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>146 events found
Event IDs: [5]
</pre></div>
</div>
</div>
</div>
<br/>
<p>Let’s get all events</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>320 events found
Event IDs: [ 1  2  3  4  5 32]
</pre></div>
</div>
</div>
</div>
<br/>
<p>In the <a href="https://mne.tools/stable/auto_tutorials/epochs/10_epochs_overview.html" title="https://mne.tools/stable/auto_tutorials/epochs/10_epochs_overview.html">MNE: Epochs tutorial</a>, a list of labels for the events in the sample data corresponding to our event_id’s is provided, which we can use to make our data a little more readable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_id</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Auditory/Left&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Auditory/Right&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;Visual/Left&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Visual/Right&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s1">&#39;smiley&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;button&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<br/>
<p>We can further use these descriptions when visulaizing our events using the <a href="https://mne.tools/stable/generated/mne.viz.plot_events.html" title="https://mne.tools/stable/generated/mne.viz.plot_events.html">plot_events()</a>
function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Specify colors for events for the plot legend</span>
<span class="n">color</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">}</span>

<span class="c1"># Plot the events to get an idea of the paradigm</span>
<span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_events</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> 
                    <span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">],</span>  <span class="c1"># sampling frequency</span>
                    <span class="n">raw</span><span class="o">.</span><span class="n">first_samp</span><span class="p">,</span>  <span class="c1"># starting point of plot (first sample)</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>  <span class="c1"># the color dict specified above</span>
                    <span class="n">event_id</span><span class="o">=</span><span class="n">event_id</span><span class="p">,</span>  <span class="c1"># our event dictionary</span>
                    <span class="n">equal_spacing</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/mne_preprocessing_120_0.png" src="../../../_images/mne_preprocessing_120_0.png" />
</div>
</div>
<br/>
<p><strong>With this information we can finally create our epochs object using the <a href="https://mne.tools/stable/generated/mne.Epochs.html" title="MNE API: mne.Epochs()">mne.Epochs()</a> constructor function</strong></p>
<p>Baseline correction will be automatically applied given the intervall between tmin (epoch start) and t = 0 (i.e. the relevant event) of specified epochs, but can be specified by adding the baseline parameter to the mne.Epochs() constructor. Baseline correction  is applied to each channel and epoch respetively by calculating the mean for the baseline period and substracting this mean from the signal of the entire epoch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># like with raw objects data is not automatically loaded into memory, therefore we set preload=True</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">reconst_sig</span><span class="p">,</span> 
                    <span class="n">events</span><span class="p">,</span> 
                    <span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eeg&#39;</span><span class="p">],</span> 
                    <span class="n">tmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># start of epoch relative to event in seconds</span>
                    <span class="n">tmax</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="c1"># end of epoch relative to event</span>
                    <span class="c1">#baseline=(-0.3,0),</span>
                    <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not setting metadata
320 matching events found
Setting baseline interval to [-0.2996928197375818, 0.0] sec
Applying baseline correction (mode: mean)
0 projection items activated
Using data from preloaded Raw for 320 events and 601 original time points ...
0 bad epochs dropped
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">info</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Measurement date</th>

        <td>December 03, 2002  19:01:10 GMT</td>

    </tr>
    <tr>
        <th>Experimenter</th>

        <td>MEG</td>

    </tr>
        <th>Participant</th>

        <td>Unknown</td>

    </tr>
    <tr>
        <th>Digitized points</th>

        <td>0 points</td>

    </tr>
    <tr>
        <th>Good channels</th>
        <td>59 EEG</td>
    </tr>
    <tr>
        <th>Bad channels</th>
        <td>None</td>
    </tr>
    <tr>
        <th>EOG channels</th>
        <td>Not available</td>
    </tr>
    <tr>
        <th>ECG channels</th>
        <td>Not available</td>

    <tr>
        <th>Sampling frequency</th>
        <td>600.61 Hz</td>
    </tr>


    <tr>
        <th>Highpass</th>
        <td>0.10 Hz</td>
    </tr>


    <tr>
        <th>Lowpass</th>
        <td>40.00 Hz</td>
    </tr>


</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Epochs |  320 events (all good), -0.299693 - 0.699283 sec, baseline -0.299693 – 0 sec, ~89.5 MB, data loaded,
 &#39;1&#39;: 72
 &#39;2&#39;: 73
 &#39;3&#39;: 73
 &#39;4&#39;: 71
 &#39;5&#39;: 15
 &#39;32&#39;: 16&gt;
</pre></div>
</div>
</div>
</div>
<br/>
Let's recreate our dictionary containing the explicit event names and add our event dict to the event object, so that we can later access data based on these labels <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;auditory/left&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;auditory/right&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;visual/left&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
              <span class="s1">&#39;visual/right&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;face&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;buttonpress&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">}</span>

<span class="n">epochs</span><span class="o">.</span><span class="n">event_id</span> <span class="o">=</span> <span class="n">event_dict</span>
<span class="nb">print</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">event_id</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Epochs |  320 events (all good), -0.299693 - 0.699283 sec, baseline -0.299693 – 0 sec, ~89.5 MB, data loaded,
 &#39;auditory/left&#39;: 72
 &#39;auditory/right&#39;: 73
 &#39;visual/left&#39;: 73
 &#39;visual/right&#39;: 71
 &#39;face&#39;: 15
 &#39;buttonpress&#39;: 16&gt;
{&#39;auditory/left&#39;: 1, &#39;auditory/right&#39;: 2, &#39;visual/left&#39;: 3, &#39;visual/right&#39;: 4, &#39;face&#39;: 5, &#39;buttonpress&#39;: 32}
</pre></div>
</div>
</div>
</div>
<br/>
<p><strong>We can visualize epochs in the same way we visualized raw data previously</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span>  <span class="c1"># pick first 5 epochs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening epochs-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_128_1.png" src="../../../_images/mne_preprocessing_128_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">);</span>  <span class="c1">#or plot all by event type</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You seem to have overlapping epochs. Some event lines may be duplicated in the plot.
Opening epochs-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_129_1.png" src="../../../_images/mne_preprocessing_129_1.png" />
</div>
</div>
<br/>
<p><strong>We can then select epochs based on the events they are centered around in a number of ways.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">event_id</span> <span class="c1"># recall what our events are</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;auditory/left&#39;: 1,
 &#39;auditory/right&#39;: 2,
 &#39;visual/left&#39;: 3,
 &#39;visual/right&#39;: 4,
 &#39;face&#39;: 5,
 &#39;buttonpress&#39;: 32}
</pre></div>
</div>
</div>
</div>
<br/>
Select by a specific group of events (MNE treats the "/" character as a string separator, so we can explicitly call only auditory epochs etc.)<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;auditory&#39;</span><span class="p">]</span>  <span class="c1"># epochs centered around presentation of auditory stimulus</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Number of events</th>
        <td>145</td>
    </tr>
    <tr>
        <th>Events</th>

        <td>auditory/left: 72<br/>auditory/right: 73</td>

    </tr>
    <tr>
        <th>Time range</th>
        <td>-0.300 – 0.699 sec</td>
    </tr>
    <tr>
        <th>Baseline</th>
        <td>-0.300 – 0.000 sec</td>
    </tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;visual&#39;</span><span class="p">]</span>  <span class="c1"># epochs centered around presentation of visual stimulus</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Number of events</th>
        <td>144</td>
    </tr>
    <tr>
        <th>Events</th>

        <td>visual/left: 73<br/>visual/right: 71</td>

    </tr>
    <tr>
        <th>Time range</th>
        <td>-0.300 – 0.699 sec</td>
    </tr>
    <tr>
        <th>Baseline</th>
        <td>-0.300 – 0.000 sec</td>
    </tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span>  <span class="c1"># subselect only stimuli presented on the right side</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Number of events</th>
        <td>144</td>
    </tr>
    <tr>
        <th>Events</th>

        <td>auditory/right: 73<br/>visual/right: 71</td>

    </tr>
    <tr>
        <th>Time range</th>
        <td>-0.300 – 0.699 sec</td>
    </tr>
    <tr>
        <th>Baseline</th>
        <td>-0.300 – 0.000 sec</td>
    </tr>
</table></div></div>
</div>
<br/>
select by multiple tags (i.e select all epochs containing either "right" or "auditory")<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="p">[[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;auditory&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Number of events</th>
        <td>216</td>
    </tr>
    <tr>
        <th>Events</th>

        <td>auditory/left: 72<br/>auditory/right: 73<br/>visual/right: 71</td>

    </tr>
    <tr>
        <th>Time range</th>
        <td>-0.300 – 0.699 sec</td>
    </tr>
    <tr>
        <th>Baseline</th>
        <td>-0.300 – 0.000 sec</td>
    </tr>
</table></div></div>
</div>
<br/>
or by using the explicit label of the specific event<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># using explicit label </span>
<span class="n">epochs</span><span class="p">[[</span><span class="s1">&#39;auditory/right&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Number of events</th>
        <td>73</td>
    </tr>
    <tr>
        <th>Events</th>

        <td>auditory/right: 73</td>

    </tr>
    <tr>
        <th>Time range</th>
        <td>-0.300 – 0.699 sec</td>
    </tr>
    <tr>
        <th>Baseline</th>
        <td>-0.300 – 0.000 sec</td>
    </tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># using explicit label </span>
<span class="n">epochs</span><span class="p">[[</span><span class="s1">&#39;auditory/left&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Number of events</th>
        <td>72</td>
    </tr>
    <tr>
        <th>Events</th>

        <td>auditory/left: 72</td>

    </tr>
    <tr>
        <th>Time range</th>
        <td>-0.300 – 0.699 sec</td>
    </tr>
    <tr>
        <th>Baseline</th>
        <td>-0.300 – 0.000 sec</td>
    </tr>
</table></div></div>
</div>
<br/>
<p><strong>We can further select epochs by their index using list comprehensions.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">epochs</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>    <span class="c1"># first 10 epochs</span>
<span class="nb">print</span><span class="p">(</span><span class="n">epochs</span><span class="p">[:</span><span class="mi">10</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># epochs 1, 3, 5, 7, 9; i.e [start:stop:step-size]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;auditory&#39;</span><span class="p">][:</span><span class="mi">10</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># or select explicitly</span>
<span class="nb">print</span><span class="p">(</span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;auditory&#39;</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>  <span class="c1"># or select explicitly</span>

<span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;auditory&#39;</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Epochs |  10 events (all good), -0.299693 - 0.699283 sec, baseline -0.299693 – 0 sec, ~5.7 MB, data loaded,
 &#39;auditory/left&#39;: 2
 &#39;auditory/right&#39;: 3
 &#39;visual/left&#39;: 3
 &#39;visual/right&#39;: 2&gt;
&lt;Epochs |  5 events (all good), -0.299693 - 0.699283 sec, baseline -0.299693 – 0 sec, ~4.3 MB, data loaded,
 &#39;auditory/left&#39;: 2
 &#39;auditory/right&#39;: 3&gt;
&lt;Epochs |  5 events (all good), -0.299693 - 0.699283 sec, baseline -0.299693 – 0 sec, ~4.3 MB, data loaded,
 &#39;auditory/right&#39;: 5&gt;
&lt;Epochs |  5 events (all good), -0.299693 - 0.699283 sec, baseline -0.299693 – 0 sec, ~4.3 MB, data loaded,
 &#39;auditory/right&#39;: 5&gt;
Opening epochs-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_142_1.png" src="../../../_images/mne_preprocessing_142_1.png" />
</div>
</div>
<br/>
<p>and access the contained data again via the get_data() function, which returns a np.array of the shape (number of epochs, number of channels, number of time-points)</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">get_data</span><span class="p">())</span>  <span class="c1"># array (n_epochs, n_channels, n_times)</span>
<span class="n">epochs</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[[-1.53682615e-07  1.76059818e-07  4.55425791e-08 ...  4.66550977e-06
    6.94681262e-06  8.74132001e-06]
  [-4.28382745e-06 -3.49376566e-06 -2.85756692e-06 ...  5.60403187e-06
    5.43679679e-06  5.40910467e-06]
  [-4.85437478e-06 -4.64429674e-06 -4.16165507e-06 ...  2.27513486e-06
    1.89663829e-06  1.79428859e-06]
  ...
  [ 3.35085006e-06  3.47503013e-06  3.59880996e-06 ... -2.00678158e-08
    1.43032391e-07  1.75713615e-07]
  [ 1.31399230e-06  1.59594277e-06  1.87315172e-06 ...  1.97230798e-06
    2.16159788e-06  2.08545430e-06]
  [ 7.25402012e-07  1.04189705e-06  1.34003488e-06 ...  2.82710672e-06
    3.41396440e-06  3.85433967e-06]]

 [[ 4.64551860e-06  3.90649334e-06  3.28822790e-06 ...  5.63972371e-07
   -5.21831787e-07 -9.94766115e-07]
  [ 7.45167295e-07  3.55688679e-07  1.15773946e-07 ...  7.99763618e-06
    7.19334948e-06  6.26835613e-06]
  [ 3.48602309e-07  1.87500662e-06  3.19319823e-06 ...  3.31106000e-06
    2.70358563e-06  1.94277926e-06]
  ...
  [ 5.17067054e-06  4.05747927e-06  2.93335543e-06 ... -5.54946242e-06
   -5.50878638e-06 -5.26299066e-06]
  [ 7.38617217e-06  6.12807183e-06  4.86596465e-06 ... -8.42704701e-06
   -8.12953102e-06 -7.67334640e-06]
  [ 7.56366149e-06  5.83487060e-06  4.07970764e-06 ... -3.52390454e-06
   -3.45058487e-06 -3.19576949e-06]]

 [[ 1.67427915e-06 -1.13946695e-06 -3.62678453e-06 ...  4.85706439e-07
    4.55079880e-07  9.52289357e-07]
  [-5.83282436e-06 -6.13049379e-06 -5.90408157e-06 ... -4.66571775e-07
   -6.17774107e-08  5.13695493e-08]
  [-1.06519330e-06 -9.20978931e-07 -9.80404889e-07 ...  3.56359963e-06
    3.51655502e-06  3.04688327e-06]
  ...
  [-1.48378732e-06 -1.32193529e-06 -1.18729764e-06 ...  4.53864671e-06
    3.83354904e-06  3.31875283e-06]
  [-3.76960095e-06 -3.78089683e-06 -3.84300244e-06 ...  1.03272991e-05
    1.00680286e-05  9.99091390e-06]
  [-3.12580784e-06 -3.26408254e-06 -3.44502031e-06 ...  8.85148157e-06
    8.56356462e-06  8.50910574e-06]]

 ...

 [[-1.87237854e-06  7.18146951e-07  3.51660927e-06 ... -6.29168059e-06
   -4.54383481e-06 -2.11190230e-06]
  [ 4.81603907e-06  5.04946591e-06  5.13868853e-06 ... -4.94531185e-06
   -4.97220961e-06 -5.07371964e-06]
  [ 5.65301378e-06  5.11656564e-06  4.64714044e-06 ...  1.30510483e-06
    1.48293489e-06  1.33107029e-06]
  ...
  [ 2.17570774e-07  7.24294584e-07  1.04130851e-06 ...  4.28638637e-06
    3.72271948e-06  3.31784829e-06]
  [-1.85931552e-07  7.03611458e-07  1.49298204e-06 ...  4.16153876e-06
    3.69673032e-06  3.39122725e-06]
  [ 7.81214707e-06  8.90456041e-06  9.58787343e-06 ...  3.95649325e-06
    3.55336633e-06  3.29187149e-06]]

 [[-4.56775313e-06 -3.34700827e-06 -1.85870347e-06 ...  4.29361468e-06
    2.94738042e-06  1.80587888e-06]
  [-4.12421691e-06 -2.45423672e-06 -8.01773770e-07 ...  4.29305115e-06
    5.20202706e-06  6.08471246e-06]
  [ 3.27680218e-06  2.48652766e-06  1.25414300e-06 ...  1.40655487e-06
    1.67555253e-07 -8.08913443e-07]
  ...
  [-1.51311651e-06 -2.62835174e-06 -3.57270721e-06 ... -2.01864024e-06
   -2.51029450e-06 -3.09512036e-06]
  [-3.70268660e-06 -4.61556389e-06 -5.31468319e-06 ... -1.35587008e-06
   -1.68548067e-06 -2.13219053e-06]
  [-7.21197971e-06 -8.13994446e-06 -8.72953656e-06 ...  3.64902277e-06
    2.73889986e-06  1.74774836e-06]]

 [[-2.86123094e-06 -3.53559767e-06 -4.35971041e-06 ...  4.80155580e-06
    5.81152796e-06  6.56062802e-06]
  [-6.71461642e-06 -7.43655085e-06 -7.97031815e-06 ...  2.75508035e-06
    2.82709293e-06  2.33934311e-06]
  [-7.42875044e-06 -7.68666695e-06 -7.85106038e-06 ...  5.48707012e-06
    6.75174390e-06  7.43535738e-06]
  ...
  [ 4.94542204e-06  4.97139574e-06  4.92222094e-06 ... -6.45984166e-06
   -6.83550041e-06 -6.97351499e-06]
  [ 1.90698871e-06  2.13430977e-06  2.27413534e-06 ... -1.77069376e-06
   -2.41846962e-06 -2.86636557e-06]
  [ 2.26846110e-06  2.35898308e-06  2.37712169e-06 ... -4.31921181e-06
   -4.72863701e-06 -4.81716241e-06]]]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(320, 59, 601)
</pre></div>
</div>
</div>
</div>
<br/>
<p>return data for all channels and all time-points for the first 2 epochs</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[:</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># first 2 epochs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[-1.53682615e-07,  1.76059818e-07,  4.55425791e-08, ...,
          4.66550977e-06,  6.94681262e-06,  8.74132001e-06],
        [-4.28382745e-06, -3.49376566e-06, -2.85756692e-06, ...,
          5.60403187e-06,  5.43679679e-06,  5.40910467e-06],
        [-4.85437478e-06, -4.64429674e-06, -4.16165507e-06, ...,
          2.27513486e-06,  1.89663829e-06,  1.79428859e-06],
        ...,
        [ 3.35085006e-06,  3.47503013e-06,  3.59880996e-06, ...,
         -2.00678158e-08,  1.43032391e-07,  1.75713615e-07],
        [ 1.31399230e-06,  1.59594277e-06,  1.87315172e-06, ...,
          1.97230798e-06,  2.16159788e-06,  2.08545430e-06],
        [ 7.25402012e-07,  1.04189705e-06,  1.34003488e-06, ...,
          2.82710672e-06,  3.41396440e-06,  3.85433967e-06]]])
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get data only from last channel of first epoch</span>
<span class="n">epochs</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">58</span><span class="p">]</span> <span class="c1"># array of shape (n_epochs, n_channels, n_times)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 7.25402012e-07,  1.04189705e-06,  1.34003488e-06,  1.59969878e-06,
        1.79864303e-06,  1.91752791e-06,  1.94524463e-06,  1.88383816e-06,
        1.75102161e-06,  1.57914142e-06,  1.41131460e-06,  1.29542790e-06,
        1.27588378e-06,  1.38466490e-06,  1.63345919e-06,  2.00927004e-06,
        2.47429604e-06,  2.96952822e-06,  3.42224362e-06,  3.75663999e-06,
        3.90628001e-06,  3.82543721e-06,  3.49761876e-06,  2.94083845e-06,
        2.20736239e-06,  1.37707635e-06,  5.46778039e-07, -1.83185063e-07,
       -7.24199222e-07, -1.01321881e-06, -1.02270717e-06, -7.65294039e-07,
       -2.92293203e-07,  3.13229067e-07,  9.48214875e-07,  1.50464269e-06,
        1.88538563e-06,  2.01879662e-06,  1.86948560e-06,  1.44312972e-06,
        7.85190425e-07, -2.60623527e-08, -8.91179942e-07, -1.70444344e-06,
       -2.36941662e-06, -2.81278663e-06, -2.99450320e-06, -2.91234651e-06,
       -2.60123216e-06, -2.12691103e-06, -1.57550316e-06, -1.04030856e-06,
       -6.08283410e-07, -3.47841800e-07, -2.99407625e-07, -4.70464206e-07,
       -8.35786708e-07, -1.34211408e-06, -1.91622405e-06, -2.47573224e-06,
       -2.94070015e-06, -3.24426663e-06, -3.34152163e-06, -3.21520211e-06,
       -2.87657250e-06, -2.36267469e-06, -1.73075179e-06, -1.04942069e-06,
       -3.88725456e-07,  1.88972740e-07,  6.36910996e-07,  9.29418721e-07,
        1.06418514e-06,  1.06098467e-06,  9.57301458e-07,  8.01972574e-07,
        6.46991489e-07,  5.38421295e-07,  5.08692333e-07,  5.71833006e-07,
        7.21562516e-07,  9.31839598e-07,  1.16078992e-06,  1.35830683e-06,
        1.47486254e-06,  1.46963842e-06,  1.31776050e-06,  1.01564079e-06,
        5.82616258e-07,  5.84106584e-08, -5.02485526e-07, -1.03857543e-06,
       -1.49094986e-06, -1.81309673e-06, -1.97877086e-06, -1.98623001e-06,
       -1.85843549e-06, -1.64002212e-06, -1.39056849e-06, -1.17435864e-06,
       -1.04932372e-06, -1.05734347e-06, -1.21727940e-06, -1.52075222e-06,
       -1.93242909e-06, -2.39532434e-06, -2.83911133e-06, -3.19023218e-06,
       -3.38362111e-06, -3.37364330e-06, -3.14156304e-06, -2.69845392e-06,
       -2.08404380e-06, -1.36114630e-06, -6.06561927e-07,  9.97694024e-08,
        6.85854803e-07,  1.09639548e-06,  1.29903538e-06,  1.28824640e-06,
        1.08411605e-06,  7.26515065e-07,  2.67289613e-07, -2.38316052e-07,
       -7.40146351e-07, -1.19957957e-06, -1.59333820e-06, -1.91445979e-06,
       -2.16981270e-06, -2.37534567e-06, -2.54980439e-06, -2.70822031e-06,
       -2.85712626e-06, -2.99210559e-06, -3.09792589e-06, -3.15133466e-06,
       -3.12629216e-06, -3.00041084e-06, -2.76047370e-06, -2.40677038e-06,
       -1.95555685e-06, -1.43794567e-06, -8.96268286e-07, -3.78438968e-07,
        6.96969057e-08,  4.12126765e-07,  6.28435783e-07,  7.16894361e-07,
        6.94848119e-07,  5.95504977e-07,  4.62354715e-07,  3.42153596e-07,
        2.76187274e-07,  2.92446472e-07,  4.02133737e-07,  5.98920779e-07,
        8.60087026e-07,  1.15158822e-06,  1.43582041e-06,  1.67842149e-06,
        1.85443108e-06,  1.95271129e-06,  1.97750107e-06,  1.94668140e-06,
        1.88705360e-06,  1.82815225e-06,  1.79560104e-06,  1.80560384e-06,
        1.86196864e-06,  1.95589336e-06,  2.06868614e-06,  2.17626061e-06,
        2.25510722e-06,  2.28923979e-06,  2.27562494e-06,  2.22579567e-06,
        2.16451427e-06,  2.12586904e-06,  2.14657589e-06,  2.25785198e-06,
        2.47755350e-06,  2.80497999e-06,  3.21864803e-06,  3.67716851e-06,
        4.12471356e-06,  4.49983909e-06,  4.74475034e-06,  4.81451566e-06,
        4.68549385e-06,  4.36029677e-06,  3.86792997e-06,  3.26050093e-06,
        2.60655468e-06,  1.98146890e-06,  1.45715425e-06,  1.09217909e-06,
        9.23588974e-07,  9.62091273e-07,  1.19111124e-06,  1.56941584e-06,
        2.03632070e-06,  2.51965595e-06,  2.94521729e-06,  3.24613304e-06,
        3.37060827e-06,  3.28795474e-06,  2.99275468e-06,  2.50591510e-06,
        1.87316685e-06,  1.16126794e-06,  4.51875424e-07, -1.66512384e-07,
       -6.08022330e-07, -7.98418848e-07, -6.83724327e-07, -2.37688628e-07,
        5.33919264e-07,  1.59252682e-06,  2.86939793e-06,  4.27227546e-06,
        5.69600741e-06,  7.03521502e-06,  8.19687057e-06,  9.11199847e-06,
        9.74472430e-06,  1.00967152e-05,  1.02068074e-05,  1.01455073e-05,
        1.00040496e-05,  9.88068891e-06,  9.86685335e-06,  1.00343263e-05,
        1.04255989e-05,  1.10483179e-05,  1.18749106e-05,  1.28482047e-05,
        1.38913610e-05,  1.49193858e-05,  1.58505706e-05,  1.66165748e-05,
        1.71701757e-05,  1.74887746e-05,  1.75735170e-05,  1.74447359e-05,
        1.71358262e-05,  1.66872043e-05,  1.61403342e-05,  1.55341477e-05,
        1.49041996e-05,  1.42829844e-05,  1.37011828e-05,  1.31895768e-05,
        1.27795111e-05,  1.25016901e-05,  1.23834125e-05,  1.24435005e-05,
        1.26866284e-05,  1.30987352e-05,  1.36442452e-05,  1.42666814e-05,
        1.48936759e-05,  1.54450879e-05,  1.58434005e-05,  1.60252758e-05,
        1.59515556e-05,  1.56136054e-05,  1.50352434e-05,  1.42696798e-05,
        1.33912745e-05,  1.24829218e-05,  1.16225428e-05,  1.08707522e-05,
        1.02615791e-05,  9.79869313e-06,  9.45751432e-06,  9.19269309e-06,
        8.94923043e-06,  8.67500435e-06,  8.33232517e-06,  7.90671837e-06,
        7.41034945e-06,  6.87878105e-06,  6.36266915e-06,  5.91623511e-06,
        5.58430685e-06,  5.39032214e-06,  5.32871449e-06,  5.36398190e-06,
        5.43609786e-06,  5.47112279e-06,  5.39549306e-06,  5.15138987e-06,
        4.71031809e-06,  4.08146235e-06,  3.31259969e-06,  2.48383005e-06,
        1.69504807e-06,  1.04840771e-06,  6.29019973e-07,  4.88417028e-07,
        6.33912565e-07,  1.02525440e-06,  1.57952400e-06,  2.18445716e-06,
        2.71770821e-06,  3.06782770e-06,  3.15417683e-06,  2.94264980e-06,
        2.45274788e-06,  1.75442915e-06,  9.56360665e-07,  1.87930855e-07,
       -4.22126798e-07, -7.67223983e-07, -7.80578142e-07, -4.45690747e-07,
        2.02368033e-07,  1.08400723e-06,  2.08974081e-06,  3.10066211e-06,
        4.00928477e-06,  4.73627967e-06,  5.24138666e-06,  5.52666820e-06,
        5.63129900e-06,  5.61926528e-06,  5.56282869e-06,  5.52493623e-06,
        5.54434144e-06,  5.62620496e-06,  5.74065019e-06,  5.83006033e-06,
        5.82339910e-06,  5.65381730e-06,  5.27714034e-06,  4.68827338e-06,
        3.93097383e-06,  3.09790192e-06,  2.32210739e-06,  1.76038973e-06,
        1.56976490e-06,  1.88213491e-06,  2.78140298e-06,  4.28663255e-06,
        6.34446281e-06,  8.83219245e-06,  1.15712339e-05,  1.43485408e-05,
        1.69435195e-05,  1.91567260e-05,  2.08350262e-05,  2.18893581e-05,
        2.23025936e-05,  2.21270596e-05,  2.14733166e-05,  2.04905400e-05,
        1.93414536e-05,  1.81770207e-05,  1.71153694e-05,  1.62265808e-05,
        1.55261122e-05,  1.49777968e-05,  1.45052345e-05,  1.40091338e-05,
        1.33872380e-05,  1.25545185e-05,  1.14603228e-05,  1.00986970e-05,
        8.51131928e-06,  6.78252840e-06,  5.02736544e-06,  3.37431054e-06,
        1.94569600e-06,  8.39600995e-07,  1.15510365e-07, -2.13985579e-07,
       -1.84335256e-07,  1.26264715e-07,  6.08809994e-07,  1.14037236e-06,
        1.60202027e-06,  1.89542640e-06,  1.95603041e-06,  1.76108387e-06,
        1.33131409e-06,  7.25574058e-07,  2.99305052e-08, -6.56959947e-07,
       -1.23963777e-06, -1.64014049e-06, -1.80949460e-06, -1.73404139e-06,
       -1.43572012e-06, -9.67158535e-07, -4.02546218e-07,  1.74241203e-07,
        6.82267236e-07,  1.05451588e-06,  1.24580810e-06,  1.23705941e-06,
        1.03518871e-06,  6.69062427e-07,  1.82813602e-07, -3.72556744e-07,
       -9.48074519e-07, -1.50407882e-06, -2.01429757e-06, -2.46784422e-06,
       -2.86819392e-06, -3.22949312e-06, -3.57179493e-06, -3.91613891e-06,
       -4.28072026e-06, -4.67790894e-06, -5.11198336e-06, -5.57850309e-06,
       -6.06553078e-06, -6.55569725e-06, -7.02825829e-06, -7.46062795e-06,
       -7.82968022e-06, -8.11347009e-06, -8.29292991e-06, -8.35298486e-06,
       -8.28347594e-06, -8.08090803e-06, -7.75005102e-06, -7.30478129e-06,
       -6.76832733e-06, -6.17260481e-06, -5.55576886e-06, -4.95845530e-06,
       -4.41954097e-06, -3.97187365e-06, -3.63809065e-06, -3.42690210e-06,
       -3.33138574e-06, -3.32964019e-06, -3.38782461e-06, -3.46496435e-06,
       -3.51816592e-06, -3.50823791e-06, -3.40510305e-06, -3.19210268e-06,
       -2.86708688e-06, -2.44065881e-06, -1.93370346e-06, -1.37334312e-06,
       -7.87477679e-07, -2.00820835e-07,  3.67343661e-07,  9.04778590e-07,
        1.40652022e-06,  1.87327554e-06,  2.30867821e-06,  2.71627406e-06,
        3.09770065e-06,  3.45180801e-06,  3.77439707e-06,  4.05962121e-06,
        4.30277383e-06,  4.50289312e-06,  4.66521778e-06,  4.80265389e-06,
        4.93463246e-06,  5.08441055e-06,  5.27582278e-06,  5.52884856e-06,
        5.85492073e-06,  6.25290217e-06,  6.70670992e-06,  7.18542192e-06,
        7.64582634e-06,  8.03746094e-06,  8.30899929e-06,  8.41494446e-06,
        8.32223406e-06,  8.01565981e-06,  7.50039011e-06,  6.80254123e-06,
        5.96760948e-06,  5.05546362e-06,  4.13337554e-06,  3.26898097e-06,
        2.52329872e-06,  1.94362335e-06,  1.55851552e-06,  1.37588334e-06,
        1.38340041e-06,  1.55066515e-06,  1.83324932e-06,  2.17835098e-06,
        2.53135388e-06,  2.84187900e-06,  3.06866582e-06,  3.18355810e-06,
        3.17377096e-06,  3.04131579e-06,  2.80107290e-06,  2.47844163e-06,
        2.10549234e-06,  1.71669585e-06,  1.34567296e-06,  1.02205184e-06,
        7.69466908e-07,  6.04533957e-07,  5.36499999e-07,  5.68216763e-07,
        6.97649152e-07,  9.18644418e-07,  1.22128427e-06,  1.59249138e-06,
        2.01677120e-06,  2.47606206e-06,  2.94925403e-06,  3.41232491e-06,
        3.83940114e-06,  4.20455901e-06,  4.48401364e-06,  4.65889145e-06,
        4.71845289e-06,  4.66254602e-06,  4.50215643e-06,  4.25877246e-06,
        3.96269287e-06,  3.64977784e-06,  3.35695804e-06,  3.11753069e-06,
        2.95687599e-06,  2.88876896e-06,  2.91308410e-06,  3.01595123e-06,
        3.17250854e-06,  3.35070978e-06,  3.51588383e-06,  3.63593258e-06,
        3.68659656e-06,  3.65532638e-06,  3.54296122e-06,  3.36329488e-06,
        3.14077981e-06,  2.90633660e-06,  2.69221798e-06,  2.52716923e-06,
        2.43239163e-06,  2.41831962e-06,  2.48333104e-06,  2.61422255e-06,
        2.78836685e-06,  2.97751078e-06,  3.15268988e-06,  3.28869115e-06,
        3.36716410e-06,  3.37897351e-06,  3.32587504e-06,  3.21927575e-06,
        3.07692411e-06,  2.91883513e-06,  2.76316872e-06,  2.62226515e-06,
        2.49976358e-06,  2.38943912e-06,  2.27619633e-06,  2.13848051e-06,
        1.95203915e-06,  1.69556317e-06,  1.35673843e-06,  9.36639187e-07,
        4.52604540e-07, -6.16397491e-08, -5.58624222e-07, -9.82730042e-07,
       -1.27786092e-06, -1.39575792e-06, -1.30477961e-06, -9.96284576e-07,
       -4.87778903e-07,  1.76232214e-07,  9.27857189e-07,  1.68389964e-06,
        2.35616237e-06,  2.86336912e-06,  3.14261216e-06,  3.15853098e-06,
        2.90894889e-06,  2.42592165e-06,  1.77199194e-06,  1.03205586e-06,
        3.01831610e-07, -3.24850366e-07, -7.68477626e-07, -9.74142050e-07,
       -9.17567287e-07, -6.07215832e-07, -8.15778237e-08,  5.98360091e-07,
        1.35905670e-06,  2.12470925e-06,  2.82710672e-06,  3.41396440e-06,
        3.85433967e-06])
</pre></div>
</div>
</div>
</div>
<br/>
<p>So to get get the signal amplitude for the last time_point only from the last channel of the first epoch, we would do the following</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">58</span><span class="p">][</span><span class="mi">600</span><span class="p">]</span> <span class="c1"># array of shape (n_epochs, n_channels, n_times)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.85433967048037e-06
</pre></div>
</div>
</div>
</div>
<br/>
<p><strong>At this point it honestly get’s quite confusing, so it might be preferable to switch to a pandas DataFrame, although this may cost computation time later on if you’re going to iterate over data for group level analysis etc.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">epochs</span><span class="o">.</span><span class="n">to_data_frame</span><span class="p">()</span> <span class="c1"># create dataframe with nested index</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>condition</th>
      <th>epoch</th>
      <th>EEG 001</th>
      <th>EEG 002</th>
      <th>EEG 003</th>
      <th>EEG 004</th>
      <th>EEG 005</th>
      <th>EEG 006</th>
      <th>EEG 007</th>
      <th>...</th>
      <th>EEG 050</th>
      <th>EEG 051</th>
      <th>EEG 052</th>
      <th>EEG 054</th>
      <th>EEG 055</th>
      <th>EEG 056</th>
      <th>EEG 057</th>
      <th>EEG 058</th>
      <th>EEG 059</th>
      <th>EEG 060</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-300</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>-0.153683</td>
      <td>-4.283827</td>
      <td>-4.854375</td>
      <td>-0.359896</td>
      <td>0.394279</td>
      <td>-4.400797</td>
      <td>-1.202811</td>
      <td>...</td>
      <td>1.431784</td>
      <td>2.940984</td>
      <td>1.983121</td>
      <td>3.429693</td>
      <td>3.401887</td>
      <td>2.569775</td>
      <td>2.850704</td>
      <td>3.350850</td>
      <td>1.313992</td>
      <td>0.725402</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-298</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>0.176060</td>
      <td>-3.493766</td>
      <td>-4.644297</td>
      <td>0.552180</td>
      <td>1.194767</td>
      <td>-4.472432</td>
      <td>-1.341450</td>
      <td>...</td>
      <td>1.512172</td>
      <td>3.084569</td>
      <td>2.321209</td>
      <td>3.474450</td>
      <td>3.641959</td>
      <td>2.769474</td>
      <td>2.967791</td>
      <td>3.475030</td>
      <td>1.595943</td>
      <td>1.041897</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-296</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>0.045543</td>
      <td>-2.857567</td>
      <td>-4.161655</td>
      <td>1.254199</td>
      <td>2.031740</td>
      <td>-4.396951</td>
      <td>-1.585917</td>
      <td>...</td>
      <td>1.583144</td>
      <td>3.254512</td>
      <td>2.717577</td>
      <td>3.489031</td>
      <td>3.913700</td>
      <td>3.017219</td>
      <td>3.061254</td>
      <td>3.598810</td>
      <td>1.873152</td>
      <td>1.340035</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-295</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>-0.487266</td>
      <td>-2.430577</td>
      <td>-3.500332</td>
      <td>1.659076</td>
      <td>2.812987</td>
      <td>-4.197414</td>
      <td>-1.938551</td>
      <td>...</td>
      <td>1.629139</td>
      <td>3.434417</td>
      <td>3.133356</td>
      <td>3.460027</td>
      <td>4.174354</td>
      <td>3.271970</td>
      <td>3.116720</td>
      <td>3.708310</td>
      <td>2.110935</td>
      <td>1.599699</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-293</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>-1.306986</td>
      <td>-2.231490</td>
      <td>-2.770353</td>
      <td>1.707647</td>
      <td>3.458586</td>
      <td>-3.905500</td>
      <td>-2.383247</td>
      <td>...</td>
      <td>1.637843</td>
      <td>3.602114</td>
      <td>3.523734</td>
      <td>3.372418</td>
      <td>4.380678</td>
      <td>3.488600</td>
      <td>3.119026</td>
      <td>3.786206</td>
      <td>2.278554</td>
      <td>1.798643</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>192315</th>
      <td>693</td>
      <td>buttonpress</td>
      <td>319</td>
      <td>2.177424</td>
      <td>1.226092</td>
      <td>1.980371</td>
      <td>4.027102</td>
      <td>3.636770</td>
      <td>5.895603</td>
      <td>-2.627936</td>
      <td>...</td>
      <td>0.908393</td>
      <td>0.714505</td>
      <td>-0.155360</td>
      <td>-4.270140</td>
      <td>-2.087490</td>
      <td>-0.133901</td>
      <td>-5.459906</td>
      <td>-5.161124</td>
      <td>-0.079998</td>
      <td>-2.859459</td>
    </tr>
    <tr>
      <th>192316</th>
      <td>694</td>
      <td>buttonpress</td>
      <td>319</td>
      <td>3.568347</td>
      <td>2.174715</td>
      <td>3.814056</td>
      <td>5.023037</td>
      <td>4.723616</td>
      <td>7.064501</td>
      <td>-0.862772</td>
      <td>...</td>
      <td>0.302466</td>
      <td>0.040847</td>
      <td>-1.079467</td>
      <td>-5.185661</td>
      <td>-2.753452</td>
      <td>-0.917123</td>
      <td>-6.363676</td>
      <td>-5.877935</td>
      <td>-0.965209</td>
      <td>-3.658738</td>
    </tr>
    <tr>
      <th>192317</th>
      <td>696</td>
      <td>buttonpress</td>
      <td>319</td>
      <td>4.801556</td>
      <td>2.755080</td>
      <td>5.487070</td>
      <td>6.010036</td>
      <td>5.894544</td>
      <td>8.044493</td>
      <td>1.102437</td>
      <td>...</td>
      <td>-0.300690</td>
      <td>-0.659023</td>
      <td>-2.043852</td>
      <td>-5.954887</td>
      <td>-3.406557</td>
      <td>-1.700440</td>
      <td>-7.101583</td>
      <td>-6.459842</td>
      <td>-1.770694</td>
      <td>-4.319212</td>
    </tr>
    <tr>
      <th>192318</th>
      <td>698</td>
      <td>buttonpress</td>
      <td>319</td>
      <td>5.811528</td>
      <td>2.827093</td>
      <td>6.751744</td>
      <td>6.947730</td>
      <td>7.003489</td>
      <td>8.759697</td>
      <td>3.042707</td>
      <td>...</td>
      <td>-0.827598</td>
      <td>-1.294786</td>
      <td>-2.913984</td>
      <td>-6.503422</td>
      <td>-3.974303</td>
      <td>-2.391284</td>
      <td>-7.588334</td>
      <td>-6.835500</td>
      <td>-2.418470</td>
      <td>-4.728637</td>
    </tr>
    <tr>
      <th>192319</th>
      <td>699</td>
      <td>buttonpress</td>
      <td>319</td>
      <td>6.560628</td>
      <td>2.339343</td>
      <td>7.435357</td>
      <td>7.795346</td>
      <td>7.910856</td>
      <td>9.166593</td>
      <td>4.723978</td>
      <td>...</td>
      <td>-1.217629</td>
      <td>-1.791663</td>
      <td>-3.578393</td>
      <td>-6.796471</td>
      <td>-4.408558</td>
      <td>-2.925173</td>
      <td>-7.784173</td>
      <td>-6.973515</td>
      <td>-2.866366</td>
      <td>-4.817162</td>
    </tr>
  </tbody>
</table>
<p>192320 rows × 62 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EEG 001&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        -0.153683
1         0.176060
2         0.045543
3        -0.487266
4        -1.306986
            ...   
192315    2.177424
192316    3.568347
192317    4.801556
192318    5.811528
192319    6.560628
Name: EEG 001, Length: 192320, dtype: float64
</pre></div>
</div>
</div>
</div>
<br/>
access DataFrame for the first 3 epochs<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;epoch&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>condition</th>
      <th>epoch</th>
      <th>EEG 001</th>
      <th>EEG 002</th>
      <th>EEG 003</th>
      <th>EEG 004</th>
      <th>EEG 005</th>
      <th>EEG 006</th>
      <th>EEG 007</th>
      <th>...</th>
      <th>EEG 050</th>
      <th>EEG 051</th>
      <th>EEG 052</th>
      <th>EEG 054</th>
      <th>EEG 055</th>
      <th>EEG 056</th>
      <th>EEG 057</th>
      <th>EEG 058</th>
      <th>EEG 059</th>
      <th>EEG 060</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1202</th>
      <td>-300</td>
      <td>auditory/left</td>
      <td>2</td>
      <td>1.674279</td>
      <td>-5.832824</td>
      <td>-1.065193</td>
      <td>1.883506</td>
      <td>5.954980</td>
      <td>2.699902</td>
      <td>-2.285878</td>
      <td>...</td>
      <td>-0.104895</td>
      <td>-1.505234</td>
      <td>-0.529909</td>
      <td>1.899286</td>
      <td>-3.035422</td>
      <td>-2.038059</td>
      <td>1.035239</td>
      <td>-1.483787</td>
      <td>-3.769601</td>
      <td>-3.125808</td>
    </tr>
    <tr>
      <th>1203</th>
      <td>-298</td>
      <td>auditory/left</td>
      <td>2</td>
      <td>-1.139467</td>
      <td>-6.130494</td>
      <td>-0.920979</td>
      <td>1.742139</td>
      <td>6.821386</td>
      <td>1.957775</td>
      <td>-1.995849</td>
      <td>...</td>
      <td>-0.224304</td>
      <td>-1.505949</td>
      <td>-0.838635</td>
      <td>2.545271</td>
      <td>-2.980840</td>
      <td>-2.069036</td>
      <td>1.434824</td>
      <td>-1.321935</td>
      <td>-3.780897</td>
      <td>-3.264083</td>
    </tr>
    <tr>
      <th>1204</th>
      <td>-296</td>
      <td>auditory/left</td>
      <td>2</td>
      <td>-3.626785</td>
      <td>-5.904082</td>
      <td>-0.980405</td>
      <td>1.820046</td>
      <td>7.347637</td>
      <td>1.134160</td>
      <td>-1.841423</td>
      <td>...</td>
      <td>-0.337660</td>
      <td>-1.557832</td>
      <td>-1.188400</td>
      <td>3.153409</td>
      <td>-3.003274</td>
      <td>-2.200103</td>
      <td>1.786290</td>
      <td>-1.187298</td>
      <td>-3.843002</td>
      <td>-3.445020</td>
    </tr>
    <tr>
      <th>1205</th>
      <td>-295</td>
      <td>auditory/left</td>
      <td>2</td>
      <td>-5.608351</td>
      <td>-5.208556</td>
      <td>-1.205763</td>
      <td>2.047516</td>
      <td>7.496192</td>
      <td>0.325561</td>
      <td>-1.847855</td>
      <td>...</td>
      <td>-0.395011</td>
      <td>-1.616724</td>
      <td>-1.508391</td>
      <td>3.711745</td>
      <td>-3.050096</td>
      <td>-2.358457</td>
      <td>2.106030</td>
      <td>-1.042580</td>
      <td>-3.901562</td>
      <td>-3.629170</td>
    </tr>
    <tr>
      <th>1206</th>
      <td>-293</td>
      <td>auditory/left</td>
      <td>2</td>
      <td>-6.982464</td>
      <td>-4.166364</td>
      <td>-1.525351</td>
      <td>2.319378</td>
      <td>7.273102</td>
      <td>-0.392720</td>
      <td>-2.024001</td>
      <td>...</td>
      <td>-0.351401</td>
      <td>-1.628021</td>
      <td>-1.722664</td>
      <td>4.218457</td>
      <td>-3.057204</td>
      <td>-2.458569</td>
      <td>2.419665</td>
      <td>-0.845292</td>
      <td>-3.896153</td>
      <td>-3.770549</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1798</th>
      <td>693</td>
      <td>auditory/left</td>
      <td>2</td>
      <td>2.043974</td>
      <td>-1.729950</td>
      <td>2.528953</td>
      <td>-2.284008</td>
      <td>0.338302</td>
      <td>-12.519796</td>
      <td>-8.186935</td>
      <td>...</td>
      <td>7.011435</td>
      <td>2.393073</td>
      <td>1.964756</td>
      <td>6.236749</td>
      <td>7.292279</td>
      <td>6.802502</td>
      <td>7.313462</td>
      <td>6.041348</td>
      <td>11.048047</td>
      <td>9.728544</td>
    </tr>
    <tr>
      <th>1799</th>
      <td>694</td>
      <td>auditory/left</td>
      <td>2</td>
      <td>1.041975</td>
      <td>-1.069995</td>
      <td>3.209934</td>
      <td>-2.245922</td>
      <td>1.779407</td>
      <td>-12.104938</td>
      <td>-8.419878</td>
      <td>...</td>
      <td>6.809046</td>
      <td>2.163413</td>
      <td>1.783681</td>
      <td>5.497183</td>
      <td>6.954686</td>
      <td>6.565084</td>
      <td>6.652048</td>
      <td>5.317792</td>
      <td>10.685427</td>
      <td>9.278551</td>
    </tr>
    <tr>
      <th>1800</th>
      <td>696</td>
      <td>auditory/left</td>
      <td>2</td>
      <td>0.485706</td>
      <td>-0.466572</td>
      <td>3.563600</td>
      <td>-2.100884</td>
      <td>3.173691</td>
      <td>-11.122786</td>
      <td>-8.233974</td>
      <td>...</td>
      <td>6.593292</td>
      <td>2.003936</td>
      <td>1.744278</td>
      <td>4.588079</td>
      <td>6.616948</td>
      <td>6.399289</td>
      <td>5.856608</td>
      <td>4.538647</td>
      <td>10.327299</td>
      <td>8.851482</td>
    </tr>
    <tr>
      <th>1801</th>
      <td>698</td>
      <td>auditory/left</td>
      <td>2</td>
      <td>0.455080</td>
      <td>-0.061777</td>
      <td>3.516555</td>
      <td>-1.933487</td>
      <td>4.267798</td>
      <td>-9.708467</td>
      <td>-7.613939</td>
      <td>...</td>
      <td>6.450861</td>
      <td>1.997810</td>
      <td>1.904081</td>
      <td>3.625994</td>
      <td>6.383641</td>
      <td>6.379514</td>
      <td>5.046047</td>
      <td>3.833549</td>
      <td>10.068029</td>
      <td>8.563565</td>
    </tr>
    <tr>
      <th>1802</th>
      <td>699</td>
      <td>auditory/left</td>
      <td>2</td>
      <td>0.952289</td>
      <td>0.051370</td>
      <td>3.046883</td>
      <td>-1.844444</td>
      <td>4.837383</td>
      <td>-8.071486</td>
      <td>-6.613888</td>
      <td>...</td>
      <td>6.458237</td>
      <td>2.208595</td>
      <td>2.299780</td>
      <td>2.735686</td>
      <td>6.345867</td>
      <td>6.563920</td>
      <td>4.340881</td>
      <td>3.318753</td>
      <td>9.990914</td>
      <td>8.509106</td>
    </tr>
  </tbody>
</table>
<p>601 rows × 62 columns</p>
</div></div></div>
</div>
<br/>
access epochs containing certain conditions<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;auditory/right&#39;</span><span class="p">]</span>  <span class="c1"># access epochs containing certain condition</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>condition</th>
      <th>epoch</th>
      <th>EEG 001</th>
      <th>EEG 002</th>
      <th>EEG 003</th>
      <th>EEG 004</th>
      <th>EEG 005</th>
      <th>EEG 006</th>
      <th>EEG 007</th>
      <th>...</th>
      <th>EEG 050</th>
      <th>EEG 051</th>
      <th>EEG 052</th>
      <th>EEG 054</th>
      <th>EEG 055</th>
      <th>EEG 056</th>
      <th>EEG 057</th>
      <th>EEG 058</th>
      <th>EEG 059</th>
      <th>EEG 060</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-300</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>-0.153683</td>
      <td>-4.283827</td>
      <td>-4.854375</td>
      <td>-0.359896</td>
      <td>0.394279</td>
      <td>-4.400797</td>
      <td>-1.202811</td>
      <td>...</td>
      <td>1.431784</td>
      <td>2.940984</td>
      <td>1.983121</td>
      <td>3.429693</td>
      <td>3.401887</td>
      <td>2.569775</td>
      <td>2.850704</td>
      <td>3.350850</td>
      <td>1.313992</td>
      <td>0.725402</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-298</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>0.176060</td>
      <td>-3.493766</td>
      <td>-4.644297</td>
      <td>0.552180</td>
      <td>1.194767</td>
      <td>-4.472432</td>
      <td>-1.341450</td>
      <td>...</td>
      <td>1.512172</td>
      <td>3.084569</td>
      <td>2.321209</td>
      <td>3.474450</td>
      <td>3.641959</td>
      <td>2.769474</td>
      <td>2.967791</td>
      <td>3.475030</td>
      <td>1.595943</td>
      <td>1.041897</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-296</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>0.045543</td>
      <td>-2.857567</td>
      <td>-4.161655</td>
      <td>1.254199</td>
      <td>2.031740</td>
      <td>-4.396951</td>
      <td>-1.585917</td>
      <td>...</td>
      <td>1.583144</td>
      <td>3.254512</td>
      <td>2.717577</td>
      <td>3.489031</td>
      <td>3.913700</td>
      <td>3.017219</td>
      <td>3.061254</td>
      <td>3.598810</td>
      <td>1.873152</td>
      <td>1.340035</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-295</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>-0.487266</td>
      <td>-2.430577</td>
      <td>-3.500332</td>
      <td>1.659076</td>
      <td>2.812987</td>
      <td>-4.197414</td>
      <td>-1.938551</td>
      <td>...</td>
      <td>1.629139</td>
      <td>3.434417</td>
      <td>3.133356</td>
      <td>3.460027</td>
      <td>4.174354</td>
      <td>3.271970</td>
      <td>3.116720</td>
      <td>3.708310</td>
      <td>2.110935</td>
      <td>1.599699</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-293</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>-1.306986</td>
      <td>-2.231490</td>
      <td>-2.770353</td>
      <td>1.707647</td>
      <td>3.458586</td>
      <td>-3.905500</td>
      <td>-2.383247</td>
      <td>...</td>
      <td>1.637843</td>
      <td>3.602114</td>
      <td>3.523734</td>
      <td>3.372418</td>
      <td>4.380678</td>
      <td>3.488600</td>
      <td>3.119026</td>
      <td>3.786206</td>
      <td>2.278554</td>
      <td>1.798643</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>189911</th>
      <td>693</td>
      <td>auditory/right</td>
      <td>315</td>
      <td>-5.079067</td>
      <td>-1.246712</td>
      <td>1.783957</td>
      <td>-8.151322</td>
      <td>-3.918948</td>
      <td>-7.072288</td>
      <td>-5.418097</td>
      <td>...</td>
      <td>1.261009</td>
      <td>0.157957</td>
      <td>-3.381464</td>
      <td>-0.743014</td>
      <td>0.518337</td>
      <td>-1.923513</td>
      <td>-2.839258</td>
      <td>-6.641621</td>
      <td>-2.358054</td>
      <td>-4.796171</td>
    </tr>
    <tr>
      <th>189912</th>
      <td>694</td>
      <td>auditory/right</td>
      <td>315</td>
      <td>-3.837659</td>
      <td>-2.927242</td>
      <td>1.225115</td>
      <td>-9.141204</td>
      <td>-4.650545</td>
      <td>-7.129471</td>
      <td>-5.996793</td>
      <td>...</td>
      <td>1.455271</td>
      <td>0.235975</td>
      <td>-3.178535</td>
      <td>-0.681336</td>
      <td>0.589503</td>
      <td>-1.697325</td>
      <td>-2.546469</td>
      <td>-6.249273</td>
      <td>-2.154781</td>
      <td>-3.983449</td>
    </tr>
    <tr>
      <th>189913</th>
      <td>696</td>
      <td>auditory/right</td>
      <td>315</td>
      <td>-2.791697</td>
      <td>-4.747554</td>
      <td>0.463874</td>
      <td>-9.929189</td>
      <td>-4.818245</td>
      <td>-6.417768</td>
      <td>-6.079887</td>
      <td>...</td>
      <td>1.703780</td>
      <td>0.372526</td>
      <td>-2.914523</td>
      <td>-0.548596</td>
      <td>0.705804</td>
      <td>-1.404995</td>
      <td>-2.165034</td>
      <td>-5.768835</td>
      <td>-1.912190</td>
      <td>-3.176036</td>
    </tr>
    <tr>
      <th>189914</th>
      <td>698</td>
      <td>auditory/right</td>
      <td>315</td>
      <td>-2.036109</td>
      <td>-6.489735</td>
      <td>-0.503002</td>
      <td>-10.361328</td>
      <td>-4.388295</td>
      <td>-4.839074</td>
      <td>-5.676215</td>
      <td>...</td>
      <td>1.956369</td>
      <td>0.533225</td>
      <td>-2.617024</td>
      <td>-0.355357</td>
      <td>0.826090</td>
      <td>-1.086330</td>
      <td>-1.738569</td>
      <td>-5.249411</td>
      <td>-1.660041</td>
      <td>-2.441243</td>
    </tr>
    <tr>
      <th>189915</th>
      <td>699</td>
      <td>auditory/right</td>
      <td>315</td>
      <td>-1.617244</td>
      <td>-7.930955</td>
      <td>-1.657449</td>
      <td>-10.331967</td>
      <td>-3.431832</td>
      <td>-2.451649</td>
      <td>-4.878071</td>
      <td>...</td>
      <td>2.166444</td>
      <td>0.684737</td>
      <td>-2.309054</td>
      <td>-0.106292</td>
      <td>0.914984</td>
      <td>-0.774094</td>
      <td>-1.304022</td>
      <td>-4.733976</td>
      <td>-1.419392</td>
      <td>-1.822676</td>
    </tr>
  </tbody>
</table>
<p>43873 rows × 62 columns</p>
</div></div></div>
</div>
<br/>
looking at the first epoch for auditory stimuli presented on the right<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;auditory/right&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;epoch&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>condition</th>
      <th>epoch</th>
      <th>EEG 001</th>
      <th>EEG 002</th>
      <th>EEG 003</th>
      <th>EEG 004</th>
      <th>EEG 005</th>
      <th>EEG 006</th>
      <th>EEG 007</th>
      <th>...</th>
      <th>EEG 050</th>
      <th>EEG 051</th>
      <th>EEG 052</th>
      <th>EEG 054</th>
      <th>EEG 055</th>
      <th>EEG 056</th>
      <th>EEG 057</th>
      <th>EEG 058</th>
      <th>EEG 059</th>
      <th>EEG 060</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-300</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>-0.153683</td>
      <td>-4.283827</td>
      <td>-4.854375</td>
      <td>-0.359896</td>
      <td>0.394279</td>
      <td>-4.400797</td>
      <td>-1.202811</td>
      <td>...</td>
      <td>1.431784</td>
      <td>2.940984</td>
      <td>1.983121</td>
      <td>3.429693</td>
      <td>3.401887</td>
      <td>2.569775</td>
      <td>2.850704</td>
      <td>3.350850</td>
      <td>1.313992</td>
      <td>0.725402</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-298</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>0.176060</td>
      <td>-3.493766</td>
      <td>-4.644297</td>
      <td>0.552180</td>
      <td>1.194767</td>
      <td>-4.472432</td>
      <td>-1.341450</td>
      <td>...</td>
      <td>1.512172</td>
      <td>3.084569</td>
      <td>2.321209</td>
      <td>3.474450</td>
      <td>3.641959</td>
      <td>2.769474</td>
      <td>2.967791</td>
      <td>3.475030</td>
      <td>1.595943</td>
      <td>1.041897</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-296</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>0.045543</td>
      <td>-2.857567</td>
      <td>-4.161655</td>
      <td>1.254199</td>
      <td>2.031740</td>
      <td>-4.396951</td>
      <td>-1.585917</td>
      <td>...</td>
      <td>1.583144</td>
      <td>3.254512</td>
      <td>2.717577</td>
      <td>3.489031</td>
      <td>3.913700</td>
      <td>3.017219</td>
      <td>3.061254</td>
      <td>3.598810</td>
      <td>1.873152</td>
      <td>1.340035</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-295</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>-0.487266</td>
      <td>-2.430577</td>
      <td>-3.500332</td>
      <td>1.659076</td>
      <td>2.812987</td>
      <td>-4.197414</td>
      <td>-1.938551</td>
      <td>...</td>
      <td>1.629139</td>
      <td>3.434417</td>
      <td>3.133356</td>
      <td>3.460027</td>
      <td>4.174354</td>
      <td>3.271970</td>
      <td>3.116720</td>
      <td>3.708310</td>
      <td>2.110935</td>
      <td>1.599699</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-293</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>-1.306986</td>
      <td>-2.231490</td>
      <td>-2.770353</td>
      <td>1.707647</td>
      <td>3.458586</td>
      <td>-3.905500</td>
      <td>-2.383247</td>
      <td>...</td>
      <td>1.637843</td>
      <td>3.602114</td>
      <td>3.523734</td>
      <td>3.372418</td>
      <td>4.380678</td>
      <td>3.488600</td>
      <td>3.119026</td>
      <td>3.786206</td>
      <td>2.278554</td>
      <td>1.798643</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>596</th>
      <td>693</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>-0.455145</td>
      <td>6.226211</td>
      <td>3.524521</td>
      <td>-1.760868</td>
      <td>1.436730</td>
      <td>-0.952867</td>
      <td>-0.575605</td>
      <td>...</td>
      <td>-5.390209</td>
      <td>7.107356</td>
      <td>6.180171</td>
      <td>-2.608987</td>
      <td>6.799990</td>
      <td>9.376177</td>
      <td>-3.391412</td>
      <td>-0.670084</td>
      <td>0.983064</td>
      <td>1.359057</td>
    </tr>
    <tr>
      <th>597</th>
      <td>694</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>2.112229</td>
      <td>5.886371</td>
      <td>2.854166</td>
      <td>-1.546046</td>
      <td>0.293328</td>
      <td>-0.279262</td>
      <td>-1.076823</td>
      <td>...</td>
      <td>-5.279555</td>
      <td>7.422220</td>
      <td>6.893315</td>
      <td>-2.349400</td>
      <td>6.982848</td>
      <td>10.153623</td>
      <td>-3.134838</td>
      <td>-0.302329</td>
      <td>1.557232</td>
      <td>2.124709</td>
    </tr>
    <tr>
      <th>598</th>
      <td>696</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>4.665510</td>
      <td>5.604032</td>
      <td>2.275135</td>
      <td>-1.128092</td>
      <td>-0.678382</td>
      <td>0.720977</td>
      <td>-1.028660</td>
      <td>...</td>
      <td>-5.317972</td>
      <td>7.551767</td>
      <td>7.389360</td>
      <td>-2.155697</td>
      <td>6.942251</td>
      <td>10.714484</td>
      <td>-2.914002</td>
      <td>-0.020068</td>
      <td>1.972308</td>
      <td>2.827107</td>
    </tr>
    <tr>
      <th>599</th>
      <td>698</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>6.946813</td>
      <td>5.436797</td>
      <td>1.896638</td>
      <td>-0.548043</td>
      <td>-1.324796</td>
      <td>1.912227</td>
      <td>-0.405261</td>
      <td>...</td>
      <td>-5.549491</td>
      <td>7.445577</td>
      <td>7.609505</td>
      <td>-2.030483</td>
      <td>6.642568</td>
      <td>10.979282</td>
      <td>-2.739930</td>
      <td>0.143032</td>
      <td>2.161598</td>
      <td>3.413964</td>
    </tr>
    <tr>
      <th>600</th>
      <td>699</td>
      <td>auditory/right</td>
      <td>0</td>
      <td>8.741320</td>
      <td>5.409105</td>
      <td>1.794289</td>
      <td>0.125558</td>
      <td>-1.529215</td>
      <td>3.150932</td>
      <td>0.748562</td>
      <td>...</td>
      <td>-5.992314</td>
      <td>7.084145</td>
      <td>7.532212</td>
      <td>-1.962733</td>
      <td>6.079477</td>
      <td>10.904114</td>
      <td>-2.610461</td>
      <td>0.175714</td>
      <td>2.085454</td>
      <td>3.854340</td>
    </tr>
  </tbody>
</table>
<p>601 rows × 62 columns</p>
</div></div></div>
</div>
<br/>
looking at the signal from a single electrode for the first epoch for auditory stimuli presented on the right (jeez)<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># looking at a subset of the dataframe</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;auditory/right&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;epoch&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)][</span><span class="s1">&#39;EEG 001&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     -0.153683
1      0.176060
2      0.045543
3     -0.487266
4     -1.306986
         ...   
596   -0.455145
597    2.112229
598    4.665510
599    6.946813
600    8.741320
Name: EEG 001, Length: 601, dtype: float64
</pre></div>
</div>
</div>
</div>
<br/>
</div>
<div class="section" id="rejecting-bad-epochs">
<h3>4.2 rejecting bad epochs<a class="headerlink" href="#rejecting-bad-epochs" title="Permalink to this headline">¶</a></h3>
<p>As discussed earlier we’ll get rid of epochs containing artifacts.</p>
<p>This way we’ll only reject a small subset of relevant data, while the rejection of ICA components or whole channels might have lead to a greater loss of relevant data in the signal. This is one of the reasons why we collect so many trials in EEG experiments.</p>
<p>As a point of caution, epoch rejection is best done after repairing our signal for eye-blinks, as otherwise we might lose a significant number of epochs.</p>
<ul class="simple">
<li><p>for more information see the <a href="https://mne.tools/stable/auto_tutorials/preprocessing/20_rejecting_bad_data.html#tut-reject-epochs-section" title="MNE tutorial: Rejecting Epochs based on channel amplitude">MNE tutorial: Rejecting Epochs based on channel amplitude</a></p></li>
</ul>
<p>For now we’ll simply <strong>reject eppochs by maximum(minimum peak-to-peak signal value thresholds</strong> (exceeding 100 µV, as it’s highly unlikely that any eeg-signal may reach this amplitude or epochs with channel with signal below 1 µV to get rid of flat channels) using the <a href="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs.drop_bad" title="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs.drop_bad">epochs.drop_bad()</a> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define upper and lower threshold as dict(channel_type:criteria)</span>
<span class="n">reject_criteria_upper</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">100e-6</span><span class="p">)</span>  <span class="c1"># 100 µV</span>
<span class="n">reject_criteria_flat</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>  <span class="c1"># 1 µV</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">drop_bad</span><span class="p">(</span><span class="n">reject</span><span class="o">=</span><span class="n">reject_criteria_upper</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="n">reject_criteria_flat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;, &#39;EEG 009&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 004&#39;, &#39;EEG 008&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;]
7 bad epochs dropped
</pre></div>
</div>
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Number of events</th>
        <td>313</td>
    </tr>
    <tr>
        <th>Events</th>

        <td>auditory/left: 70<br/>auditory/right: 72<br/>buttonpress: 16<br/>face: 14<br/>visual/left: 71<br/>visual/right: 70</td>

    </tr>
    <tr>
        <th>Time range</th>
        <td>-0.300 – 0.699 sec</td>
    </tr>
    <tr>
        <th>Baseline</th>
        <td>-0.300 – 0.000 sec</td>
    </tr>
</table></div></div>
</div>
<br/>
<p>We can then further visulaize how many epochs were dropped for each channel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">plot_drop_log</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/mne_preprocessing_166_0.png" src="../../../_images/mne_preprocessing_166_0.png" />
</div>
</div>
<br/>
If no arguments are provided for the drop_bad() function, all epochs that were marked as bad would be dropped.<br/>
<p><strong>Another strategy for rejecting epochs is to declare the above criteria while creating the epochs object</strong></p>
<p>We can specify where in the epoch to look for artifacts with the <strong>reject_tmin</strong> and <strong>reject_tmax</strong> parameters of  <a href="https://mne.tools/stable/generated/mne.Epochs.html" title="MNE API: mne.Epochs()">mne.Epochs()</a>. Reject_tmin = 0 would mean that we look for artifacts after the event, while reject_tmax = 0 would mean that we only look for artifacts in the timeframe before the event occurde. If not specified they default to the ends of the timeframe specified for the epochs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">reconst_sig</span><span class="p">,</span> 
                    <span class="n">events</span><span class="p">,</span> 
                    <span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eeg&#39;</span><span class="p">],</span> 
                    <span class="n">tmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                    <span class="n">reject_tmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span>
                    <span class="n">reject_tmax</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                    <span class="n">reject</span><span class="o">=</span><span class="n">reject_criteria_upper</span><span class="p">,</span> 
                    <span class="n">flat</span><span class="o">=</span><span class="n">reject_criteria_flat</span><span class="p">,</span> 
                    <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not setting metadata
320 matching events found
Setting baseline interval to [-0.2996928197375818, 0.0] sec
Applying baseline correction (mode: mean)
0 projection items activated
Using data from preloaded Raw for 320 events and 601 original time points ...
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;]
1 bad epochs dropped
</pre></div>
</div>
</div>
</div>
<br/>
<p>For the automatic rejection of epochs we can use the <strong>reject_by_annotation parameter</strong>.
This can be achieved by adding information about the timeframe of an artifact, break, experimental block etc. to an <a href="https://mne.tools/stable/generated/mne.Annotations.html#mne.Annotations" title="https://mne.tools/stable/generated/mne.Annotations.html#mne.Annotations">mne.Annotations</a>  object and using the <a href="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs.set_annotations" title="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs.set_annotations">.set_annotations()</a> function to add this to the .info object of our data.</p>
<p>So we’ll define 3 hypothetical breaks in the next step by <strong>specfifying their onset time, duration and adding a description</strong>. If the description contains the string “bad” annotated data-spans will be automatically excluded from most analysis steps, including the creation of epochs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">onset_breaks</span> <span class="o">=</span> <span class="p">[</span><span class="n">reconst_sig</span><span class="o">.</span><span class="n">first_time</span> <span class="o">+</span> <span class="mi">30</span><span class="p">,</span> <span class="n">reconst_sig</span><span class="o">.</span><span class="n">first_time</span> <span class="o">+</span> <span class="mi">90</span><span class="p">,</span> <span class="n">reconst_sig</span><span class="o">.</span><span class="n">first_time</span> <span class="o">+</span> <span class="mi">150</span><span class="p">]</span>
<span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">description_breaks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bad_break_1&#39;</span><span class="p">,</span> <span class="s1">&#39;bad_break_2&#39;</span><span class="p">,</span> <span class="s1">&#39;bad_break_3&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<br/>
<p>Now we create our Annotations object</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">breaks</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Annotations</span><span class="p">(</span><span class="n">onset</span><span class="o">=</span><span class="n">onset_breaks</span><span class="p">,</span>
                               <span class="n">duration</span><span class="o">=</span><span class="n">durations</span><span class="p">,</span>
                               <span class="n">description</span><span class="o">=</span><span class="n">description_breaks</span><span class="p">,</span>
                               <span class="n">orig_time</span><span class="o">=</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;meas_date&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<br/>
<p>and set the annotations to our raw object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reconst_sig</span><span class="o">.</span><span class="n">set_annotations</span><span class="p">(</span><span class="n">reconst_sig</span><span class="o">.</span><span class="n">annotations</span> <span class="o">+</span> <span class="n">breaks</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Measurement date</th>

        <td>December 03, 2002  19:01:10 GMT</td>

    </tr>
    <tr>
        <th>Experimenter</th>

        <td>MEG</td>

    </tr>
        <th>Participant</th>

        <td>Unknown</td>

    </tr>
    <tr>
        <th>Digitized points</th>

        <td>0 points</td>

    </tr>
    <tr>
        <th>Good channels</th>
        <td>59 EEG</td>
    </tr>
    <tr>
        <th>Bad channels</th>
        <td>None</td>
    </tr>
    <tr>
        <th>EOG channels</th>
        <td>Not available</td>
    </tr>
    <tr>
        <th>ECG channels</th>
        <td>Not available</td>

    <tr>
        <th>Sampling frequency</th>
        <td>600.61 Hz</td>
    </tr>


    <tr>
        <th>Highpass</th>
        <td>0.10 Hz</td>
    </tr>


    <tr>
        <th>Lowpass</th>
        <td>40.00 Hz</td>
    </tr>



    <tr>
        <th>Filenames</th>
        <td>sample_audvis_raw.fif</td>
    </tr>

    <tr>
        <th>Duration</th>
        <td>00:04:37 (HH:MM:SS)</td>
    </tr>
</table></div></div>
</div>
<br/>
Let's check how this look in our interactive plots<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reconst_sig</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Opening raw-browser...
</pre></div>
</div>
<img alt="../../../_images/mne_preprocessing_177_1.png" src="../../../_images/mne_preprocessing_177_1.png" />
</div>
</div>
<br/>
<p><strong>Now when we create our epochs object, any epoch contained in the designated “breaks” will be excluded.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">reconst_sig</span><span class="p">,</span> 
                    <span class="n">events</span><span class="p">,</span> 
                    <span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eeg&#39;</span><span class="p">],</span> 
                    <span class="n">tmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                    <span class="c1">#reject_tmin=-0.3,</span>
                    <span class="c1">#reject_tmax=0, </span>
                    <span class="n">reject</span><span class="o">=</span><span class="n">reject_criteria_upper</span><span class="p">,</span> 
                    <span class="n">flat</span><span class="o">=</span><span class="n">reject_criteria_flat</span><span class="p">,</span>
                    <span class="n">reject_by_annotation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">epochs</span><span class="o">.</span><span class="n">event_id</span> <span class="o">=</span> <span class="n">event_dict</span> <span class="c1"># rename our events</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not setting metadata
320 matching events found
Setting baseline interval to [-0.2996928197375818, 0.0] sec
Applying baseline correction (mode: mean)
0 projection items activated
Using data from preloaded Raw for 320 events and 601 original time points ...
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;, &#39;EEG 009&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 004&#39;, &#39;EEG 008&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 008&#39;]
56 bad epochs dropped
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">event_id</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;auditory/left&#39;: 1,
 &#39;auditory/right&#39;: 2,
 &#39;visual/left&#39;: 3,
 &#39;visual/right&#39;: 4,
 &#39;face&#39;: 5,
 &#39;buttonpress&#39;: 32}
</pre></div>
</div>
</div>
</div>
<br/>
<p>and to visualize the dropped epochs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">plot_drop_log</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/mne_preprocessing_182_0.png" src="../../../_images/mne_preprocessing_182_0.png" />
</div>
</div>
<br/>
<p><strong>Now we could convert this data into a dataframe for further maipulation or export our epochs as an tsv file in long format for statistical analysis.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">epochs</span><span class="o">.</span><span class="n">to_data_frame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">,</span> <span class="s1">&#39;epoch&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">])</span> <span class="c1"># create dataframe with nested index</span>
<span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>channel</th>
      <th>EEG 001</th>
      <th>EEG 002</th>
      <th>EEG 003</th>
      <th>EEG 004</th>
      <th>EEG 005</th>
      <th>EEG 006</th>
      <th>EEG 007</th>
      <th>EEG 008</th>
      <th>EEG 009</th>
      <th>EEG 010</th>
      <th>...</th>
      <th>EEG 050</th>
      <th>EEG 051</th>
      <th>EEG 052</th>
      <th>EEG 054</th>
      <th>EEG 055</th>
      <th>EEG 056</th>
      <th>EEG 057</th>
      <th>EEG 058</th>
      <th>EEG 059</th>
      <th>EEG 060</th>
    </tr>
    <tr>
      <th>condition</th>
      <th>epoch</th>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">auditory/left</th>
      <th rowspan="5" valign="top">2</th>
      <th>-300</th>
      <td>1.674279</td>
      <td>-5.832824</td>
      <td>-1.065193</td>
      <td>1.883506</td>
      <td>5.954980</td>
      <td>2.699902</td>
      <td>-2.285878</td>
      <td>-1.041173</td>
      <td>1.371179</td>
      <td>2.461690</td>
      <td>...</td>
      <td>-0.104895</td>
      <td>-1.505234</td>
      <td>-0.529909</td>
      <td>1.899286</td>
      <td>-3.035422</td>
      <td>-2.038059</td>
      <td>1.035239</td>
      <td>-1.483787</td>
      <td>-3.769601</td>
      <td>-3.125808</td>
    </tr>
    <tr>
      <th>-298</th>
      <td>-1.139467</td>
      <td>-6.130494</td>
      <td>-0.920979</td>
      <td>1.742139</td>
      <td>6.821386</td>
      <td>1.957775</td>
      <td>-1.995849</td>
      <td>0.406024</td>
      <td>0.980153</td>
      <td>2.041891</td>
      <td>...</td>
      <td>-0.224304</td>
      <td>-1.505949</td>
      <td>-0.838635</td>
      <td>2.545271</td>
      <td>-2.980840</td>
      <td>-2.069036</td>
      <td>1.434824</td>
      <td>-1.321935</td>
      <td>-3.780897</td>
      <td>-3.264083</td>
    </tr>
    <tr>
      <th>-296</th>
      <td>-3.626785</td>
      <td>-5.904082</td>
      <td>-0.980405</td>
      <td>1.820046</td>
      <td>7.347637</td>
      <td>1.134160</td>
      <td>-1.841423</td>
      <td>2.170672</td>
      <td>0.731463</td>
      <td>1.703899</td>
      <td>...</td>
      <td>-0.337660</td>
      <td>-1.557832</td>
      <td>-1.188400</td>
      <td>3.153409</td>
      <td>-3.003274</td>
      <td>-2.200103</td>
      <td>1.786290</td>
      <td>-1.187298</td>
      <td>-3.843002</td>
      <td>-3.445020</td>
    </tr>
    <tr>
      <th>-295</th>
      <td>-5.608351</td>
      <td>-5.208556</td>
      <td>-1.205763</td>
      <td>2.047516</td>
      <td>7.496192</td>
      <td>0.325561</td>
      <td>-1.847855</td>
      <td>3.967159</td>
      <td>0.648780</td>
      <td>1.442463</td>
      <td>...</td>
      <td>-0.395011</td>
      <td>-1.616724</td>
      <td>-1.508391</td>
      <td>3.711745</td>
      <td>-3.050096</td>
      <td>-2.358457</td>
      <td>2.106030</td>
      <td>-1.042580</td>
      <td>-3.901562</td>
      <td>-3.629170</td>
    </tr>
    <tr>
      <th>-293</th>
      <td>-6.982464</td>
      <td>-4.166364</td>
      <td>-1.525351</td>
      <td>2.319378</td>
      <td>7.273102</td>
      <td>-0.392720</td>
      <td>-2.024001</td>
      <td>5.483102</td>
      <td>0.738784</td>
      <td>1.243973</td>
      <td>...</td>
      <td>-0.351401</td>
      <td>-1.628021</td>
      <td>-1.722664</td>
      <td>4.218457</td>
      <td>-3.057204</td>
      <td>-2.458569</td>
      <td>2.419665</td>
      <td>-0.845292</td>
      <td>-3.896153</td>
      <td>-3.770549</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">visual/right</th>
      <th rowspan="5" valign="top">318</th>
      <th>693</th>
      <td>7.132074</td>
      <td>2.962601</td>
      <td>4.083015</td>
      <td>6.192311</td>
      <td>4.220870</td>
      <td>2.193333</td>
      <td>-2.139301</td>
      <td>4.822322</td>
      <td>7.136358</td>
      <td>2.772771</td>
      <td>...</td>
      <td>-3.877052</td>
      <td>-3.739459</td>
      <td>-1.819167</td>
      <td>-3.514831</td>
      <td>-3.185711</td>
      <td>-3.474153</td>
      <td>-1.837076</td>
      <td>-1.615154</td>
      <td>-1.390848</td>
      <td>4.738347</td>
    </tr>
    <tr>
      <th>694</th>
      <td>5.733377</td>
      <td>3.510989</td>
      <td>2.754277</td>
      <td>7.373238</td>
      <td>4.454477</td>
      <td>2.821823</td>
      <td>-2.153671</td>
      <td>8.907488</td>
      <td>5.166448</td>
      <td>2.031963</td>
      <td>...</td>
      <td>-3.833959</td>
      <td>-3.616641</td>
      <td>-1.841351</td>
      <td>-3.399617</td>
      <td>-3.245535</td>
      <td>-3.390298</td>
      <td>-1.811255</td>
      <td>-1.702233</td>
      <td>-1.236660</td>
      <td>4.347359</td>
    </tr>
    <tr>
      <th>696</th>
      <td>4.293615</td>
      <td>4.293051</td>
      <td>1.406555</td>
      <td>8.565687</td>
      <td>4.861299</td>
      <td>3.564821</td>
      <td>-1.755798</td>
      <td>13.013912</td>
      <td>3.079259</td>
      <td>1.418302</td>
      <td>...</td>
      <td>-3.879939</td>
      <td>-3.601303</td>
      <td>-1.966689</td>
      <td>-3.508406</td>
      <td>-3.450976</td>
      <td>-3.458747</td>
      <td>-2.040714</td>
      <td>-2.018640</td>
      <td>-1.355870</td>
      <td>3.649023</td>
    </tr>
    <tr>
      <th>698</th>
      <td>2.947380</td>
      <td>5.202027</td>
      <td>0.167555</td>
      <td>9.551748</td>
      <td>5.305607</td>
      <td>4.120528</td>
      <td>-1.106711</td>
      <td>16.533834</td>
      <td>1.150853</td>
      <td>0.947768</td>
      <td>...</td>
      <td>-3.953208</td>
      <td>-3.625353</td>
      <td>-2.126498</td>
      <td>-3.826098</td>
      <td>-3.719349</td>
      <td>-3.617442</td>
      <td>-2.494923</td>
      <td>-2.510294</td>
      <td>-1.685481</td>
      <td>2.738900</td>
    </tr>
    <tr>
      <th>699</th>
      <td>1.805879</td>
      <td>6.084712</td>
      <td>-0.808913</td>
      <td>10.152494</td>
      <td>5.633928</td>
      <td>4.214714</td>
      <td>-0.385346</td>
      <td>18.988465</td>
      <td>-0.379245</td>
      <td>0.601400</td>
      <td>...</td>
      <td>-3.987063</td>
      <td>-3.616629</td>
      <td>-2.246846</td>
      <td>-4.308630</td>
      <td>-3.959156</td>
      <td>-3.792737</td>
      <td>-3.110733</td>
      <td>-3.095120</td>
      <td>-2.132191</td>
      <td>1.747748</td>
    </tr>
  </tbody>
</table>
<p>158664 rows × 59 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;sub-test_ses-001_sample_audiovis_eeg_data_epo.tsv&#39;</span><span class="p">,</span> 
          <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">event_id</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;auditory/left&#39;: 1,
 &#39;auditory/right&#39;: 2,
 &#39;visual/left&#39;: 3,
 &#39;visual/right&#39;: 4,
 &#39;face&#39;: 5,
 &#39;buttonpress&#39;: 32}
</pre></div>
</div>
</div>
</div>
<br/>
<p><strong>Or save the epochs as a .fif file using epochs<a href="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs.save">.save()</a> which can be imported back into mne using the <a href="https://mne.tools/stable/generated/mne.read_epochs.html">.read_epochs()</a> function.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_path</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;sub-test_ses-001_sample_audiovis_eeg_data_epo.fif&#39;</span><span class="p">,</span>
            <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "neuro_ai"
        },
        kernelOptions: {
            kernelName: "neuro_ai",
            path: "./introduction/notebooks/neuroscience"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'neuro_ai'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="mne_introduction.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">MNE python for EEG analysis</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="mne_erp.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Evoked potentials/ERPs with MNE</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Peer Herholz<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>